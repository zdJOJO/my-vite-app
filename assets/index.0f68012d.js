var Za=Object.defineProperty,ei=Object.defineProperties;var ti=Object.getOwnPropertyDescriptors;var wr=Object.getOwnPropertySymbols;var ri=Object.prototype.hasOwnProperty,ni=Object.prototype.propertyIsEnumerable;var zr=(e,t,r)=>t in e?Za(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pt=(e,t)=>{for(var r in t||(t={}))ri.call(t,r)&&zr(e,r,t[r]);if(wr)for(var r of wr(t))ni.call(t,r)&&zr(e,r,t[r]);return e},Yt=(e,t)=>ei(e,ti(t));import{r as d,ai as Gr,h as V,i as _,_ as A,w as Ze,o as G,K as we,s as Fe,aY as ai,aZ as ii,a_ as oi,t as Te,aa as Ur,y as Ne,a3 as si,ac as ci,a7 as li,E as Vr,g as ke,S as Xt,a$ as ui,q as fi,b0 as di,p as ht,$ as Qt,b1 as Wr,b2 as kt,b3 as pi,Q as hi,b4 as mi,b5 as vi,b6 as gi,b7 as yi,aI as bi,ar as Ci,b8 as xi,as as Si,aD as Kr,b9 as _i,a5 as Ti,ba as ki,bb as Ei,bc as Pi,bd as Ri,aw as Oi,al as Di,ax as qr,be as Ii,bf as Mi,V as Ni,ae as ji,bg as Ai,bh as Fi,aH as Li,A as Bi,m as Hr,B as Et}from"./vendor.a56e9a0c.js";import{P as $i,S as wi,I as Jr}from"./index.bc622e21.js";import{b as et,c as Zt,e as Yr,F as zi,f as Gi,d as Ui}from"./index.ef2aff07.js";import{u as Vi,S as Xr}from"./index.26e5bc64.js";import{a as Le,j as Y}from"./index.45687f00.js";import"./toNumber.3a71ced3.js";var Wi=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},Ki=function(t){var r=t.prefixCls,n=t.className,a=t.hoverable,i=a===void 0?!0:a,c=Wi(t,["prefixCls","className","hoverable"]);return d.exports.createElement(Gr,null,function(l){var o=l.getPrefixCls,s=o("card",r),u=V("".concat(s,"-grid"),n,_({},"".concat(s,"-grid-hoverable"),i));return d.exports.createElement("div",A({},c,{className:u}))})},Qr=Ki,qi=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},Hi=function(t){return d.exports.createElement(Gr,null,function(r){var n=r.getPrefixCls,a=t.prefixCls,i=t.className,c=t.avatar,l=t.title,o=t.description,s=qi(t,["prefixCls","className","avatar","title","description"]),u=n("card",a),f=V("".concat(u,"-meta"),i),p=c?d.exports.createElement("div",{className:"".concat(u,"-meta-avatar")},c):null,m=l?d.exports.createElement("div",{className:"".concat(u,"-meta-title")},l):null,h=o?d.exports.createElement("div",{className:"".concat(u,"-meta-description")},o):null,v=m||h?d.exports.createElement("div",{className:"".concat(u,"-meta-detail")},m,h):null;return d.exports.createElement("div",A({},s,{className:f}),p,v)})},Ji=Hi;function Zr(e){var t=d.exports.useRef(),r=d.exports.useRef(!1);function n(){for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];r.current||(Ze.cancel(t.current),t.current=Ze(function(){e.apply(void 0,i)}))}return d.exports.useEffect(function(){return r.current=!1,function(){r.current=!0,Ze.cancel(t.current)}},[]),n}function Yi(e){var t=d.exports.useRef([]),r=d.exports.useState({}),n=G(r,2),a=n[1],i=d.exports.useRef(typeof e=="function"?e():e),c=Zr(function(){var o=i.current;t.current.forEach(function(s){o=s(o)}),t.current=[],i.current=o,a({})});function l(o){t.current.push(o),c()}return[i.current,l]}function Xi(e,t){var r,n=e.prefixCls,a=e.id,i=e.active,c=e.tab,l=c.key,o=c.tab,s=c.disabled,u=c.closeIcon,f=e.closable,p=e.renderWrapper,m=e.removeAriaLabel,h=e.editable,v=e.onClick,b=e.onRemove,g=e.onFocus,y=e.style,T="".concat(n,"-tab");d.exports.useEffect(function(){return b},[]);var k=h&&f!==!1&&!s;function S(x){s||v(x)}function M(x){x.preventDefault(),x.stopPropagation(),h.onEdit("remove",{key:l,event:x})}var P=d.exports.createElement("div",{key:l,ref:t,className:V(T,(r={},_(r,"".concat(T,"-with-remove"),k),_(r,"".concat(T,"-active"),i),_(r,"".concat(T,"-disabled"),s),r)),style:y,onClick:S},d.exports.createElement("div",{role:"tab","aria-selected":i,id:a&&"".concat(a,"-tab-").concat(l),className:"".concat(T,"-btn"),"aria-controls":a&&"".concat(a,"-panel-").concat(l),"aria-disabled":s,tabIndex:s?null:0,onClick:function(D){D.stopPropagation(),S(D)},onKeyDown:function(D){[we.SPACE,we.ENTER].includes(D.which)&&(D.preventDefault(),S(D))},onFocus:g},o),k&&d.exports.createElement("button",{type:"button","aria-label":m||"remove",tabIndex:0,className:"".concat(T,"-remove"),onClick:function(D){D.stopPropagation(),M(D)}},u||h.removeIcon||"\xD7"));return p?p(P):P}var Qi=d.exports.forwardRef(Xi),en={width:0,height:0,left:0,top:0};function Zi(e,t,r){return d.exports.useMemo(function(){for(var n,a=new Map,i=t.get((n=e[0])===null||n===void 0?void 0:n.key)||en,c=i.left+i.width,l=0;l<e.length;l+=1){var o=e[l].key,s=t.get(o);if(!s){var u;s=t.get((u=e[l-1])===null||u===void 0?void 0:u.key)||en}var f=a.get(o)||Fe({},s);f.right=c-f.left-f.width,a.set(o,f)}return a},[e.map(function(n){return n.key}).join("_"),t,r])}var tn={width:0,height:0,left:0,top:0,right:0};function eo(e,t,r,n,a){var i=a.tabs,c=a.tabPosition,l=a.rtl,o,s,u;["top","bottom"].includes(c)?(o="width",s=l?"right":"left",u=Math.abs(t.left)):(o="height",s="top",u=-t.top);var f=t[o],p=r[o],m=n[o],h=f;return p+m>f&&p<f&&(h=f-m),d.exports.useMemo(function(){if(!i.length)return[0,0];for(var v=i.length,b=v,g=0;g<v;g+=1){var y=e.get(i[g].key)||tn;if(y[s]+y[o]>u+h){b=g-1;break}}for(var T=0,k=v-1;k>=0;k-=1){var S=e.get(i[k].key)||tn;if(S[s]<u){T=k+1;break}}return[T,b]},[e,u,h,c,i.map(function(v){return v.key}).join("_"),l])}function to(e,t){var r=e.prefixCls,n=e.editable,a=e.locale,i=e.style;return!n||n.showAdd===!1?null:d.exports.createElement("button",{ref:t,type:"button",className:"".concat(r,"-nav-add"),style:i,"aria-label":(a==null?void 0:a.addAriaLabel)||"Add tab",onClick:function(l){n.onEdit("add",{event:l})}},n.addIcon||"+")}var rn=d.exports.forwardRef(to);function ro(e,t){var r=e.prefixCls,n=e.id,a=e.tabs,i=e.locale,c=e.mobile,l=e.moreIcon,o=l===void 0?"More":l,s=e.moreTransitionName,u=e.style,f=e.className,p=e.editable,m=e.tabBarGutter,h=e.rtl,v=e.removeAriaLabel,b=e.onTabClick,g=e.popupClassName,y=d.exports.useState(!1),T=G(y,2),k=T[0],S=T[1],M=d.exports.useState(null),P=G(M,2),x=P[0],D=P[1],C="".concat(n,"-more-popup"),R="".concat(r,"-dropdown"),O=x!==null?"".concat(C,"-").concat(x):null,E=i==null?void 0:i.dropdownAriaLabel;function L(N,$){N.preventDefault(),N.stopPropagation(),p.onEdit("remove",{key:$,event:N})}var F=d.exports.createElement(ai,{onClick:function($){var U=$.key,z=$.domEvent;b(U,z),S(!1)},prefixCls:"".concat(R,"-menu"),id:C,tabIndex:-1,role:"listbox","aria-activedescendant":O,selectedKeys:[x],"aria-label":E!==void 0?E:"expanded dropdown"},a.map(function(N){var $=p&&N.closable!==!1&&!N.disabled;return d.exports.createElement(ii,{key:N.key,id:"".concat(C,"-").concat(N.key),role:"option","aria-controls":n&&"".concat(n,"-panel-").concat(N.key),disabled:N.disabled},d.exports.createElement("span",null,N.tab),$&&d.exports.createElement("button",{type:"button","aria-label":v||"remove",tabIndex:0,className:"".concat(R,"-menu-item-remove"),onClick:function(z){z.stopPropagation(),L(z,N.key)}},N.closeIcon||p.removeIcon||"\xD7"))}));function w(N){for(var $=a.filter(function(ie){return!ie.disabled}),U=$.findIndex(function(ie){return ie.key===x})||0,z=$.length,W=0;W<z;W+=1){U=(U+N+z)%z;var X=$[U];if(!X.disabled){D(X.key);return}}}function K(N){var $=N.which;if(!k){[we.DOWN,we.SPACE,we.ENTER].includes($)&&(S(!0),N.preventDefault());return}switch($){case we.UP:w(-1),N.preventDefault();break;case we.DOWN:w(1),N.preventDefault();break;case we.ESC:S(!1);break;case we.SPACE:case we.ENTER:x!==null&&b(x,N);break}}d.exports.useEffect(function(){var N=document.getElementById(O);N&&N.scrollIntoView&&N.scrollIntoView(!1)},[x]),d.exports.useEffect(function(){k||D(null)},[k]);var j=_({},h?"marginRight":"marginLeft",m);a.length||(j.visibility="hidden",j.order=1);var q=V(_({},"".concat(R,"-rtl"),h)),H=c?null:d.exports.createElement(oi,{prefixCls:R,overlay:F,trigger:["hover"],visible:k,transitionName:s,onVisibleChange:S,overlayClassName:V(q,g),mouseEnterDelay:.1,mouseLeaveDelay:.1},d.exports.createElement("button",{type:"button",className:"".concat(r,"-nav-more"),style:j,tabIndex:-1,"aria-hidden":"true","aria-haspopup":"listbox","aria-controls":C,id:"".concat(n,"-more"),"aria-expanded":k,onKeyDown:K},o));return d.exports.createElement("div",{className:V("".concat(r,"-nav-operations"),f),style:u,ref:t},H,d.exports.createElement(rn,{prefixCls:r,locale:i,editable:p}))}var no=d.exports.memo(d.exports.forwardRef(ro),function(e,t){return t.tabMoving}),er=d.exports.createContext(null),ao=.1,nn=.01,Pt=20,an=Math.pow(.995,Pt);function io(e,t){var r=d.exports.useState(),n=G(r,2),a=n[0],i=n[1],c=d.exports.useState(0),l=G(c,2),o=l[0],s=l[1],u=d.exports.useState(0),f=G(u,2),p=f[0],m=f[1],h=d.exports.useState(),v=G(h,2),b=v[0],g=v[1],y=d.exports.useRef();function T(D){var C=D.touches[0],R=C.screenX,O=C.screenY;i({x:R,y:O}),window.clearInterval(y.current)}function k(D){if(!!a){D.preventDefault();var C=D.touches[0],R=C.screenX,O=C.screenY;i({x:R,y:O});var E=R-a.x,L=O-a.y;t(E,L);var F=Date.now();s(F),m(F-o),g({x:E,y:L})}}function S(){if(!!a&&(i(null),g(null),b)){var D=b.x/p,C=b.y/p,R=Math.abs(D),O=Math.abs(C);if(Math.max(R,O)<ao)return;var E=D,L=C;y.current=window.setInterval(function(){if(Math.abs(E)<nn&&Math.abs(L)<nn){window.clearInterval(y.current);return}E*=an,L*=an,t(E*Pt,L*Pt)},Pt)}}var M=d.exports.useRef();function P(D){var C=D.deltaX,R=D.deltaY,O=0,E=Math.abs(C),L=Math.abs(R);E===L?O=M.current==="x"?C:R:E>L?(O=C,M.current="x"):(O=R,M.current="y"),t(-O,-O)&&D.preventDefault()}var x=d.exports.useRef(null);x.current={onTouchStart:T,onTouchMove:k,onTouchEnd:S,onWheel:P},d.exports.useEffect(function(){function D(E){x.current.onTouchStart(E)}function C(E){x.current.onTouchMove(E)}function R(E){x.current.onTouchEnd(E)}function O(E){x.current.onWheel(E)}return document.addEventListener("touchmove",C,{passive:!1}),document.addEventListener("touchend",R,{passive:!1}),e.current.addEventListener("touchstart",D,{passive:!1}),e.current.addEventListener("wheel",O),function(){document.removeEventListener("touchmove",C),document.removeEventListener("touchend",R)}},[])}function oo(){var e=d.exports.useRef(new Map);function t(n){return e.current.has(n)||e.current.set(n,d.exports.createRef()),e.current.get(n)}function r(n){e.current.delete(n)}return[t,r]}function on(e,t){var r=d.exports.useRef(e),n=d.exports.useState({}),a=G(n,2),i=a[1];function c(l){var o=typeof l=="function"?l(r.current):l;o!==r.current&&t(o,r.current),r.current=o,i({})}return[r.current,c]}var sn=function(t){var r=t.position,n=t.prefixCls,a=t.extra;if(!a)return null;var i,c={};return a&&Ne(a)==="object"&&!d.exports.isValidElement(a)?c=a:c.right=a,r==="right"&&(i=c.right),r==="left"&&(i=c.left),i?d.exports.createElement("div",{className:"".concat(n,"-extra-content")},i):null};function so(e,t){var r,n=d.exports.useContext(er),a=n.prefixCls,i=n.tabs,c=e.className,l=e.style,o=e.id,s=e.animated,u=e.activeKey,f=e.rtl,p=e.extra,m=e.editable,h=e.locale,v=e.tabPosition,b=e.tabBarGutter,g=e.children,y=e.onTabClick,T=e.onTabScroll,k=d.exports.useRef(),S=d.exports.useRef(),M=d.exports.useRef(),P=d.exports.useRef(),x=oo(),D=G(x,2),C=D[0],R=D[1],O=v==="top"||v==="bottom",E=on(0,function(te,Q){O&&T&&T({direction:te>Q?"left":"right"})}),L=G(E,2),F=L[0],w=L[1],K=on(0,function(te,Q){!O&&T&&T({direction:te>Q?"top":"bottom"})}),j=G(K,2),q=j[0],H=j[1],N=d.exports.useState(0),$=G(N,2),U=$[0],z=$[1],W=d.exports.useState(0),X=G(W,2),ie=X[0],Re=X[1],re=d.exports.useState(null),J=G(re,2),ne=J[0],he=J[1],je=d.exports.useState(null),Be=G(je,2),se=Be[0],ce=Be[1],le=d.exports.useState(0),Oe=G(le,2),Me=Oe[0],ve=Oe[1],ee=d.exports.useState(0),ge=G(ee,2),ae=ge[0],_e=ge[1],Ge=Yi(new Map),ye=G(Ge,2),Ue=ye[0],oe=ye[1],ue=Zi(i,Ue,U),de="".concat(a,"-nav-operations-hidden"),fe=0,qe=0;O?f?(fe=0,qe=Math.max(0,U-ne)):(fe=Math.min(0,ne-U),qe=0):(fe=Math.min(0,se-ie),qe=0);function Ye(te){return te<fe?fe:te>qe?qe:te}var st=d.exports.useRef(),ct=d.exports.useState(),lt=G(ct,2),He=lt[0],Xe=lt[1];function Vt(){Xe(Date.now())}function Wt(){window.clearTimeout(st.current)}io(k,function(te,Q){function me(Ae,Qe){Ae(function(ft){var Jt=Ye(ft+Qe);return Jt})}if(O){if(ne>=U)return!1;me(w,te)}else{if(se>=ie)return!1;me(H,Q)}return Wt(),Vt(),!0}),d.exports.useEffect(function(){return Wt(),He&&(st.current=window.setTimeout(function(){Xe(0)},100)),Wt},[He]);function Er(){var te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u,Q=ue.get(te)||{width:0,height:0,left:0,right:0,top:0};if(O){var me=F;f?Q.right<F?me=Q.right:Q.right+Q.width>F+ne&&(me=Q.right+Q.width-ne):Q.left<-F?me=-Q.left:Q.left+Q.width>-F+ne&&(me=-(Q.left+Q.width-ne)),H(0),w(Ye(me))}else{var Ae=q;Q.top<-q?Ae=-Q.top:Q.top+Q.height>-q+se&&(Ae=-(Q.top+Q.height-se)),w(0),H(Ye(Ae))}}var za=eo(ue,{width:ne,height:se,left:F,top:q},{width:U,height:ie},{width:Me,height:ae},Fe(Fe({},e),{},{tabs:i})),Pr=G(za,2),Ga=Pr[0],Ua=Pr[1],Tt={};v==="top"||v==="bottom"?Tt[f?"marginRight":"marginLeft"]=b:Tt.marginTop=b;var Rr=i.map(function(te,Q){var me=te.key;return d.exports.createElement(Qi,{id:o,prefixCls:a,key:me,tab:te,style:Q===0?void 0:Tt,closable:te.closable,editable:m,active:me===u,renderWrapper:g,removeAriaLabel:h==null?void 0:h.removeAriaLabel,ref:C(me),onClick:function(Qe){y(me,Qe)},onRemove:function(){R(me)},onFocus:function(){Er(me),Vt(),!!k.current&&(f||(k.current.scrollLeft=0),k.current.scrollTop=0)}})}),Kt=Zr(function(){var te,Q,me,Ae,Qe,ft,Jt=((te=k.current)===null||te===void 0?void 0:te.offsetWidth)||0,Ja=((Q=k.current)===null||Q===void 0?void 0:Q.offsetHeight)||0,Fr=((me=P.current)===null||me===void 0?void 0:me.offsetWidth)||0,Lr=((Ae=P.current)===null||Ae===void 0?void 0:Ae.offsetHeight)||0;he(Jt),ce(Ja),ve(Fr),_e(Lr);var Ya=(((Qe=S.current)===null||Qe===void 0?void 0:Qe.offsetWidth)||0)-Fr,Xa=(((ft=S.current)===null||ft===void 0?void 0:ft.offsetHeight)||0)-Lr;z(Ya),Re(Xa),oe(function(){var Br=new Map;return i.forEach(function(Qa){var $r=Qa.key,dt=C($r).current;dt&&Br.set($r,{width:dt.offsetWidth,height:dt.offsetHeight,left:dt.offsetLeft,top:dt.offsetTop})}),Br})}),Va=i.slice(0,Ga),Wa=i.slice(Ua+1),Or=[].concat(Te(Va),Te(Wa)),Ka=d.exports.useState(),Dr=G(Ka,2),qa=Dr[0],Ha=Dr[1],Je=ue.get(u),Ir=d.exports.useRef();function Mr(){Ze.cancel(Ir.current)}d.exports.useEffect(function(){var te={};return Je&&(O?(f?te.right=Je.right:te.left=Je.left,te.width=Je.width):(te.top=Je.top,te.height=Je.height)),Mr(),Ir.current=Ze(function(){Ha(te)}),Mr},[Je,O,f]),d.exports.useEffect(function(){Er()},[u,Je,ue,O]),d.exports.useEffect(function(){Kt()},[f,b,u,i.map(function(te){return te.key}).join("_")]);var Nr=!!Or.length,ut="".concat(a,"-nav-wrap"),qt,Ht,jr,Ar;return O?f?(Ht=F>0,qt=F+ne<U):(qt=F<0,Ht=-F+ne<U):(jr=q<0,Ar=-q+se<ie),d.exports.createElement("div",{ref:t,role:"tablist",className:V("".concat(a,"-nav"),c),style:l,onKeyDown:function(){Vt()}},d.exports.createElement(sn,{position:"left",extra:p,prefixCls:a}),d.exports.createElement(Ur,{onResize:Kt},d.exports.createElement("div",{className:V(ut,(r={},_(r,"".concat(ut,"-ping-left"),qt),_(r,"".concat(ut,"-ping-right"),Ht),_(r,"".concat(ut,"-ping-top"),jr),_(r,"".concat(ut,"-ping-bottom"),Ar),r)),ref:k},d.exports.createElement(Ur,{onResize:Kt},d.exports.createElement("div",{ref:S,className:"".concat(a,"-nav-list"),style:{transform:"translate(".concat(F,"px, ").concat(q,"px)"),transition:He?"none":void 0}},Rr,d.exports.createElement(rn,{ref:P,prefixCls:a,locale:h,editable:m,style:Fe(Fe({},Rr.length===0?void 0:Tt),{},{visibility:Nr?"hidden":null})}),d.exports.createElement("div",{className:V("".concat(a,"-ink-bar"),_({},"".concat(a,"-ink-bar-animated"),s.inkBar)),style:qa}))))),d.exports.createElement(no,A({},e,{removeAriaLabel:h==null?void 0:h.removeAriaLabel,ref:M,prefixCls:a,tabs:Or,className:!Nr&&de,tabMoving:!!He})),d.exports.createElement(sn,{position:"right",extra:p,prefixCls:a}))}var cn=d.exports.forwardRef(so);function co(e){var t=e.id,r=e.activeKey,n=e.animated,a=e.tabPosition,i=e.rtl,c=e.destroyInactiveTabPane,l=d.exports.useContext(er),o=l.prefixCls,s=l.tabs,u=n.tabPane,f=s.findIndex(function(p){return p.key===r});return d.exports.createElement("div",{className:V("".concat(o,"-content-holder"))},d.exports.createElement("div",{className:V("".concat(o,"-content"),"".concat(o,"-content-").concat(a),_({},"".concat(o,"-content-animated"),u)),style:f&&u?_({},i?"marginRight":"marginLeft","-".concat(f,"00%")):null},s.map(function(p){return d.exports.cloneElement(p.node,{key:p.key,prefixCls:o,tabKey:p.key,id:t,animated:u,active:p.key===r,destroyInactiveTabPane:c})})))}function ln(e){var t=e.prefixCls,r=e.forceRender,n=e.className,a=e.style,i=e.id,c=e.active,l=e.animated,o=e.destroyInactiveTabPane,s=e.tabKey,u=e.children,f=d.exports.useState(r),p=G(f,2),m=p[0],h=p[1];d.exports.useEffect(function(){c?h(!0):o&&h(!1)},[c,o]);var v={};return c||(l?(v.visibility="hidden",v.height=0,v.overflowY="hidden"):v.display="none"),d.exports.createElement("div",{id:i&&"".concat(i,"-panel-").concat(s),role:"tabpanel",tabIndex:c?0:-1,"aria-labelledby":i&&"".concat(i,"-tab-").concat(s),"aria-hidden":!c,style:Fe(Fe({},v),a),className:V("".concat(t,"-tabpane"),c&&"".concat(t,"-tabpane-active"),n)},(c||m||r)&&u)}var lo=["id","prefixCls","className","children","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","moreIcon","moreTransitionName","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","popupClassName"],un=0;function uo(e){return ci(e).map(function(t){if(d.exports.isValidElement(t)){var r=t.key!==void 0?String(t.key):void 0;return Fe(Fe({key:r},t.props),{},{node:t})}return null}).filter(function(t){return t})}function fo(e,t){var r,n=e.id,a=e.prefixCls,i=a===void 0?"rc-tabs":a,c=e.className,l=e.children,o=e.direction,s=e.activeKey,u=e.defaultActiveKey,f=e.editable,p=e.animated,m=p===void 0?{inkBar:!0,tabPane:!1}:p,h=e.tabPosition,v=h===void 0?"top":h,b=e.tabBarGutter,g=e.tabBarStyle,y=e.tabBarExtraContent,T=e.locale,k=e.moreIcon,S=e.moreTransitionName,M=e.destroyInactiveTabPane,P=e.renderTabBar,x=e.onChange,D=e.onTabClick,C=e.onTabScroll,R=e.popupClassName,O=si(e,lo),E=uo(l),L=o==="rtl",F;m===!1?F={inkBar:!1,tabPane:!1}:m===!0?F={inkBar:!0,tabPane:!0}:F=Fe({inkBar:!0,tabPane:!1},Ne(m)==="object"?m:{});var w=d.exports.useState(!1),K=G(w,2),j=K[0],q=K[1];d.exports.useEffect(function(){q(li())},[]);var H=Vr(function(){var le;return(le=E[0])===null||le===void 0?void 0:le.key},{value:s,defaultValue:u}),N=G(H,2),$=N[0],U=N[1],z=d.exports.useState(function(){return E.findIndex(function(le){return le.key===$})}),W=G(z,2),X=W[0],ie=W[1];d.exports.useEffect(function(){var le=E.findIndex(function(Me){return Me.key===$});if(le===-1){var Oe;le=Math.max(0,Math.min(X,E.length-1)),U((Oe=E[le])===null||Oe===void 0?void 0:Oe.key)}ie(le)},[E.map(function(le){return le.key}).join("_"),$,X]);var Re=Vr(null,{value:n}),re=G(Re,2),J=re[0],ne=re[1],he=v;j&&!["left","right"].includes(v)&&(he="top"),d.exports.useEffect(function(){n||(ne("rc-tabs-".concat(un)),un+=1)},[]);function je(le,Oe){D==null||D(le,Oe);var Me=le!==$;U(le),Me&&(x==null||x(le))}var Be={id:J,activeKey:$,animated:F,tabPosition:he,rtl:L,mobile:j},se,ce=Fe(Fe({},Be),{},{editable:f,locale:T,moreIcon:k,moreTransitionName:S,tabBarGutter:b,onTabClick:je,onTabScroll:C,extra:y,style:g,panes:l,popupClassName:R});return P?se=P(ce,cn):se=d.exports.createElement(cn,ce),d.exports.createElement(er.Provider,{value:{tabs:E,prefixCls:i}},d.exports.createElement("div",A({ref:t,id:n,className:V(i,"".concat(i,"-").concat(he),(r={},_(r,"".concat(i,"-mobile"),j),_(r,"".concat(i,"-editable"),f),_(r,"".concat(i,"-rtl"),L),r),c)},O),se,d.exports.createElement(co,A({destroyInactiveTabPane:M},Be,{animated:F}))))}var fn=d.exports.forwardRef(fo);fn.TabPane=ln;var po=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};function tr(e){var t=e.type,r=e.className,n=e.size,a=e.onEdit,i=e.hideAdd,c=e.centered,l=e.addIcon,o=po(e,["type","className","size","onEdit","hideAdd","centered","addIcon"]),s=o.prefixCls,u=o.moreIcon,f=u===void 0?d.exports.createElement(ui,null):u,p=d.exports.useContext(ke),m=p.getPrefixCls,h=p.direction,v=m("tabs",s),b;t==="editable-card"&&(b={onEdit:function(T,k){var S=k.key,M=k.event;a==null||a(T==="add"?M:S,T)},removeIcon:d.exports.createElement(fi,null),addIcon:l||d.exports.createElement(di,null),showAdd:i!==!0});var g=m();return d.exports.createElement(Xt.Consumer,null,function(y){var T,k=n!==void 0?n:y;return d.exports.createElement(fn,A({direction:h,moreTransitionName:"".concat(g,"-slide-up")},o,{className:V((T={},_(T,"".concat(v,"-").concat(k),k),_(T,"".concat(v,"-card"),["card","editable-card"].includes(t)),_(T,"".concat(v,"-editable-card"),t==="editable-card"),_(T,"".concat(v,"-centered"),c),T),r),editable:b,moreIcon:f,prefixCls:v}))})}tr.TabPane=ln;var ho=function(t){var r=t.prefixCls,n=t.className,a=t.width,i=t.style;return d.exports.createElement("h3",{className:V(r,n),style:A({width:a},i)})},mo=ho,vo=function(t){var r=function(s){var u=t.width,f=t.rows,p=f===void 0?2:f;if(Array.isArray(u))return u[s];if(p-1===s)return u},n=t.prefixCls,a=t.className,i=t.style,c=t.rows,l=Te(Array(c)).map(function(o,s){return d.exports.createElement("li",{key:s,style:{width:r(s)}})});return d.exports.createElement("ul",{className:V(n,a),style:i},l)},go=vo,yo=function(t){var r,n,a=t.prefixCls,i=t.className,c=t.style,l=t.size,o=t.shape,s=V((r={},_(r,"".concat(a,"-lg"),l==="large"),_(r,"".concat(a,"-sm"),l==="small"),r)),u=V((n={},_(n,"".concat(a,"-circle"),o==="circle"),_(n,"".concat(a,"-square"),o==="square"),_(n,"".concat(a,"-round"),o==="round"),n)),f=typeof l=="number"?{width:l,height:l,lineHeight:"".concat(l,"px")}:{};return d.exports.createElement("span",{className:V(a,s,u,i),style:A(A({},f),c)})},Rt=yo,dn=function(t){var r=t.prefixCls,n=t.className,a=t.active,i=d.exports.useContext(ke),c=i.getPrefixCls,l=c("skeleton",r),o=ht(t,["prefixCls","className"]),s=V(l,"".concat(l,"-element"),_({},"".concat(l,"-active"),a),n);return d.exports.createElement("div",{className:s},d.exports.createElement(Rt,A({prefixCls:"".concat(l,"-avatar")},o)))};dn.defaultProps={size:"default",shape:"circle"};var bo=dn,pn=function(t){var r,n=t.prefixCls,a=t.className,i=t.active,c=t.block,l=c===void 0?!1:c,o=d.exports.useContext(ke),s=o.getPrefixCls,u=s("skeleton",n),f=ht(t,["prefixCls"]),p=V(u,"".concat(u,"-element"),(r={},_(r,"".concat(u,"-active"),i),_(r,"".concat(u,"-block"),l),r),a);return d.exports.createElement("div",{className:p},d.exports.createElement(Rt,A({prefixCls:"".concat(u,"-button")},f)))};pn.defaultProps={size:"default"};var Co=pn,hn=function(t){var r,n=t.prefixCls,a=t.className,i=t.active,c=t.block,l=d.exports.useContext(ke),o=l.getPrefixCls,s=o("skeleton",n),u=ht(t,["prefixCls"]),f=V(s,"".concat(s,"-element"),(r={},_(r,"".concat(s,"-active"),i),_(r,"".concat(s,"-block"),c),r),a);return d.exports.createElement("div",{className:f},d.exports.createElement(Rt,A({prefixCls:"".concat(s,"-input")},u)))};hn.defaultProps={size:"default"};var xo=hn,So="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",_o=function(t){var r=t.prefixCls,n=t.className,a=t.style,i=d.exports.useContext(ke),c=i.getPrefixCls,l=c("skeleton",r),o=V(l,"".concat(l,"-element"),n);return d.exports.createElement("div",{className:o},d.exports.createElement("div",{className:V("".concat(l,"-image"),n),style:a},d.exports.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(l,"-image-svg")},d.exports.createElement("path",{d:So,className:"".concat(l,"-image-path")}))))},To=_o;function rr(e){return e&&Ne(e)==="object"?e:{}}function ko(e,t){return e&&!t?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Eo(e,t){return!e&&t?{width:"38%"}:e&&t?{width:"50%"}:{}}function Po(e,t){var r={};return(!e||!t)&&(r.width="61%"),!e&&t?r.rows=3:r.rows=2,r}var at=function(t){var r=t.prefixCls,n=t.loading,a=t.className,i=t.style,c=t.children,l=t.avatar,o=t.title,s=t.paragraph,u=t.active,f=t.round,p=d.exports.useContext(ke),m=p.getPrefixCls,h=p.direction,v=m("skeleton",r);if(n||!("loading"in t)){var b,g=!!l,y=!!o,T=!!s,k;if(g){var S=A(A({prefixCls:"".concat(v,"-avatar")},ko(y,T)),rr(l));k=d.exports.createElement("div",{className:"".concat(v,"-header")},d.exports.createElement(Rt,S))}var M;if(y||T){var P;if(y){var x=A(A({prefixCls:"".concat(v,"-title")},Eo(g,T)),rr(o));P=d.exports.createElement(mo,x)}var D;if(T){var C=A(A({prefixCls:"".concat(v,"-paragraph")},Po(g,y)),rr(s));D=d.exports.createElement(go,C)}M=d.exports.createElement("div",{className:"".concat(v,"-content")},P,D)}var R=V(v,(b={},_(b,"".concat(v,"-with-avatar"),g),_(b,"".concat(v,"-active"),u),_(b,"".concat(v,"-rtl"),h==="rtl"),_(b,"".concat(v,"-round"),f),b),a);return d.exports.createElement("div",{className:R,style:i},k,M)}return typeof c!="undefined"?c:null};at.defaultProps={avatar:!1,title:!0,paragraph:!0};at.Button=Co;at.Avatar=bo;at.Input=xo;at.Image=To;var Ro=at,Oo=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};function Do(e){var t=e.map(function(r,n){return d.exports.createElement("li",{style:{width:"".concat(100/e.length,"%")},key:"action-".concat(n)},d.exports.createElement("span",null,r))});return t}var Io=d.exports.forwardRef(function(e,t){var r,n,a=d.exports.useContext(ke),i=a.getPrefixCls,c=a.direction,l=d.exports.useContext(Xt),o=function(ne){var he;(he=e.onTabChange)===null||he===void 0||he.call(e,ne)},s=function(){var ne;return d.exports.Children.forEach(e.children,function(he){he&&he.type&&he.type===Qr&&(ne=!0)}),ne},u=e.prefixCls,f=e.className,p=e.extra,m=e.headStyle,h=m===void 0?{}:m,v=e.bodyStyle,b=v===void 0?{}:v,g=e.title,y=e.loading,T=e.bordered,k=T===void 0?!0:T,S=e.size,M=e.type,P=e.cover,x=e.actions,D=e.tabList,C=e.children,R=e.activeTabKey,O=e.defaultActiveTabKey,E=e.tabBarExtraContent,L=e.hoverable,F=e.tabProps,w=F===void 0?{}:F,K=Oo(e,["prefixCls","className","extra","headStyle","bodyStyle","title","loading","bordered","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps"]),j=i("card",u),q=d.exports.createElement(Ro,{loading:!0,active:!0,paragraph:{rows:4},title:!1},C),H=R!==void 0,N=A(A({},w),(r={},_(r,H?"activeKey":"defaultActiveKey",H?R:O),_(r,"tabBarExtraContent",E),r)),$,U=D&&D.length?d.exports.createElement(tr,A({size:"large"},N,{className:"".concat(j,"-head-tabs"),onChange:o}),D.map(function(J){return d.exports.createElement(tr.TabPane,{tab:J.tab,disabled:J.disabled,key:J.key})})):null;(g||p||U)&&($=d.exports.createElement("div",{className:"".concat(j,"-head"),style:h},d.exports.createElement("div",{className:"".concat(j,"-head-wrapper")},g&&d.exports.createElement("div",{className:"".concat(j,"-head-title")},g),p&&d.exports.createElement("div",{className:"".concat(j,"-extra")},p)),U));var z=P?d.exports.createElement("div",{className:"".concat(j,"-cover")},P):null,W=d.exports.createElement("div",{className:"".concat(j,"-body"),style:b},y?q:C),X=x&&x.length?d.exports.createElement("ul",{className:"".concat(j,"-actions")},Do(x)):null,ie=ht(K,["onTabChange"]),Re=S||l,re=V(j,(n={},_(n,"".concat(j,"-loading"),y),_(n,"".concat(j,"-bordered"),k),_(n,"".concat(j,"-hoverable"),L),_(n,"".concat(j,"-contain-grid"),s()),_(n,"".concat(j,"-contain-tabs"),D&&D.length),_(n,"".concat(j,"-").concat(Re),Re),_(n,"".concat(j,"-type-").concat(M),!!M),_(n,"".concat(j,"-rtl"),c==="rtl"),n),f);return d.exports.createElement("div",A({ref:t},ie,{className:re}),$,z,W,X)}),Mo=Io,nr=Mo;nr.Grid=Qr;nr.Meta=Ji;var Ot=nr,No=d.exports.createContext({}),mn=No,jo=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};Qt("top","middle","bottom","stretch");Qt("start","end","center","space-around","space-between","space-evenly");var vn=d.exports.forwardRef(function(e,t){var r,n=e.prefixCls,a=e.justify,i=e.align,c=e.className,l=e.style,o=e.children,s=e.gutter,u=s===void 0?0:s,f=e.wrap,p=jo(e,["prefixCls","justify","align","className","style","children","gutter","wrap"]),m=d.exports.useContext(ke),h=m.getPrefixCls,v=m.direction,b=d.exports.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),g=G(b,2),y=g[0],T=g[1],k=Vi(),S=d.exports.useRef(u);d.exports.useEffect(function(){var j=Wr.subscribe(function(q){var H=S.current||0;(!Array.isArray(H)&&Ne(H)==="object"||Array.isArray(H)&&(Ne(H[0])==="object"||Ne(H[1])==="object"))&&T(q)});return function(){return Wr.unsubscribe(j)}},[]);var M=function(){var q=[void 0,void 0],H=Array.isArray(u)?u:[u,void 0];return H.forEach(function(N,$){if(Ne(N)==="object")for(var U=0;U<kt.length;U++){var z=kt[U];if(y[z]&&N[z]!==void 0){q[$]=N[z];break}}else q[$]=N}),q},P=h("row",n),x=M(),D=V(P,(r={},_(r,"".concat(P,"-no-wrap"),f===!1),_(r,"".concat(P,"-").concat(a),a),_(r,"".concat(P,"-").concat(i),i),_(r,"".concat(P,"-rtl"),v==="rtl"),r),c),C={},R=x[0]!=null&&x[0]>0?x[0]/-2:void 0,O=x[1]!=null&&x[1]>0?x[1]/-2:void 0;if(R&&(C.marginLeft=R,C.marginRight=R),k){var E=G(x,2);C.rowGap=E[1]}else O&&(C.marginTop=O,C.marginBottom=O);var L=G(x,2),F=L[0],w=L[1],K=d.exports.useMemo(function(){return{gutter:[F,w],wrap:f,supportFlexGap:k}},[F,w,f,k]);return d.exports.createElement(mn.Provider,{value:K},d.exports.createElement("div",A({},p,{className:D,style:A(A({},C),l),ref:t}),o))});vn.displayName="Row";var Dt=vn,Ao=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};function Fo(e){return typeof e=="number"?"".concat(e," ").concat(e," auto"):/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?"0 0 ".concat(e):e}var Lo=["xs","sm","md","lg","xl","xxl"],gn=d.exports.forwardRef(function(e,t){var r,n=d.exports.useContext(ke),a=n.getPrefixCls,i=n.direction,c=d.exports.useContext(mn),l=c.gutter,o=c.wrap,s=c.supportFlexGap,u=e.prefixCls,f=e.span,p=e.order,m=e.offset,h=e.push,v=e.pull,b=e.className,g=e.children,y=e.flex,T=e.style,k=Ao(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),S=a("col",u),M={};Lo.forEach(function(R){var O,E={},L=e[R];typeof L=="number"?E.span=L:Ne(L)==="object"&&(E=L||{}),delete k[R],M=A(A({},M),(O={},_(O,"".concat(S,"-").concat(R,"-").concat(E.span),E.span!==void 0),_(O,"".concat(S,"-").concat(R,"-order-").concat(E.order),E.order||E.order===0),_(O,"".concat(S,"-").concat(R,"-offset-").concat(E.offset),E.offset||E.offset===0),_(O,"".concat(S,"-").concat(R,"-push-").concat(E.push),E.push||E.push===0),_(O,"".concat(S,"-").concat(R,"-pull-").concat(E.pull),E.pull||E.pull===0),_(O,"".concat(S,"-rtl"),i==="rtl"),O))});var P=V(S,(r={},_(r,"".concat(S,"-").concat(f),f!==void 0),_(r,"".concat(S,"-order-").concat(p),p),_(r,"".concat(S,"-offset-").concat(m),m),_(r,"".concat(S,"-push-").concat(h),h),_(r,"".concat(S,"-pull-").concat(v),v),r),b,M),x={};if(l&&l[0]>0){var D=l[0]/2;x.paddingLeft=D,x.paddingRight=D}if(l&&l[1]>0&&!s){var C=l[1]/2;x.paddingTop=C,x.paddingBottom=C}return y&&(x.flex=Fo(y),o===!1&&!x.minWidth&&(x.minWidth=0)),d.exports.createElement("div",A({},k,{style:A(A({},x),T),className:P,ref:t}),g)});gn.displayName="Col";var tt=gn;function yn(e){return typeof e=="object"&&e!=null&&e.nodeType===1}function bn(e,t){return(!t||e!=="hidden")&&e!=="visible"&&e!=="clip"}function ar(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var r=getComputedStyle(e,null);return bn(r.overflowY,t)||bn(r.overflowX,t)||function(n){var a=function(i){if(!i.ownerDocument||!i.ownerDocument.defaultView)return null;try{return i.ownerDocument.defaultView.frameElement}catch{return null}}(n);return!!a&&(a.clientHeight<n.scrollHeight||a.clientWidth<n.scrollWidth)}(e)}return!1}function It(e,t,r,n,a,i,c,l){return i<e&&c>t||i>e&&c<t?0:i<=e&&l<=r||c>=t&&l>=r?i-e-n:c>t&&l<r||i<e&&l>r?c-t+a:0}function Cn(e,t){var r=window,n=t.scrollMode,a=t.block,i=t.inline,c=t.boundary,l=t.skipOverflowHiddenElements,o=typeof c=="function"?c:function(J){return J!==c};if(!yn(e))throw new TypeError("Invalid target");for(var s=document.scrollingElement||document.documentElement,u=[],f=e;yn(f)&&o(f);){if((f=f.parentElement)===s){u.push(f);break}f!=null&&f===document.body&&ar(f)&&!ar(document.documentElement)||f!=null&&ar(f,l)&&u.push(f)}for(var p=r.visualViewport?r.visualViewport.width:innerWidth,m=r.visualViewport?r.visualViewport.height:innerHeight,h=window.scrollX||pageXOffset,v=window.scrollY||pageYOffset,b=e.getBoundingClientRect(),g=b.height,y=b.width,T=b.top,k=b.right,S=b.bottom,M=b.left,P=a==="start"||a==="nearest"?T:a==="end"?S:T+g/2,x=i==="center"?M+y/2:i==="end"?k:M,D=[],C=0;C<u.length;C++){var R=u[C],O=R.getBoundingClientRect(),E=O.height,L=O.width,F=O.top,w=O.right,K=O.bottom,j=O.left;if(n==="if-needed"&&T>=0&&M>=0&&S<=m&&k<=p&&T>=F&&S<=K&&M>=j&&k<=w)return D;var q=getComputedStyle(R),H=parseInt(q.borderLeftWidth,10),N=parseInt(q.borderTopWidth,10),$=parseInt(q.borderRightWidth,10),U=parseInt(q.borderBottomWidth,10),z=0,W=0,X="offsetWidth"in R?R.offsetWidth-R.clientWidth-H-$:0,ie="offsetHeight"in R?R.offsetHeight-R.clientHeight-N-U:0;if(s===R)z=a==="start"?P:a==="end"?P-m:a==="nearest"?It(v,v+m,m,N,U,v+P,v+P+g,g):P-m/2,W=i==="start"?x:i==="center"?x-p/2:i==="end"?x-p:It(h,h+p,p,H,$,h+x,h+x+y,y),z=Math.max(0,z+v),W=Math.max(0,W+h);else{z=a==="start"?P-F-N:a==="end"?P-K+U+ie:a==="nearest"?It(F,K,E,N,U+ie,P,P+g,g):P-(F+E/2)+ie/2,W=i==="start"?x-j-H:i==="center"?x-(j+L/2)+X/2:i==="end"?x-w+$+X:It(j,w,L,H,$+X,x,x+y,y);var Re=R.scrollLeft,re=R.scrollTop;P+=re-(z=Math.max(0,Math.min(re+z,R.scrollHeight-E+ie))),x+=Re-(W=Math.max(0,Math.min(Re+W,R.scrollWidth-L+X)))}D.push({el:R,top:z,left:W})}return D}function xn(e){return e===Object(e)&&Object.keys(e).length!==0}function Bo(e,t){t===void 0&&(t="auto");var r="scrollBehavior"in document.body.style;e.forEach(function(n){var a=n.el,i=n.top,c=n.left;a.scroll&&r?a.scroll({top:i,left:c,behavior:t}):(a.scrollTop=i,a.scrollLeft=c)})}function $o(e){return e===!1?{block:"end",inline:"nearest"}:xn(e)?e:{block:"start",inline:"nearest"}}function wo(e,t){var r=e.isConnected||e.ownerDocument.documentElement.contains(e);if(xn(t)&&typeof t.behavior=="function")return t.behavior(r?Cn(e,t):[]);if(!!r){var n=$o(t);return Bo(Cn(e,n),n.behavior)}}var zo=["parentNode"],Go="form_item";function mt(e){return e===void 0||e===!1?[]:Array.isArray(e)?e:[e]}function Sn(e,t){if(!!e.length){var r=e.join("_");if(t)return"".concat(t,"_").concat(r);var n=zo.indexOf(r)>=0;return n?"".concat(Go,"_").concat(r):r}}function _n(e){var t=mt(e);return t.join("_")}function ir(e){var t=pi(),r=G(t,1),n=r[0],a=d.exports.useRef({}),i=d.exports.useMemo(function(){return e!=null?e:A(A({},n),{__INTERNAL__:{itemRef:function(l){return function(o){var s=_n(l);o?a.current[s]=o:delete a.current[s]}}},scrollToField:function(l){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=mt(l),u=Sn(s,i.__INTERNAL__.name),f=u?document.getElementById(u):null;f&&wo(f,A({scrollMode:"if-needed",block:"nearest"},o))},getFieldInstance:function(l){var o=_n(l);return a.current[o]}})},[e,n]);return[i]}var Uo=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},Vo=function(t,r){var n,a=d.exports.useContext(Xt),i=d.exports.useContext(hi),c=d.exports.useContext(ke),l=c.getPrefixCls,o=c.direction,s=c.form,u=t.prefixCls,f=t.className,p=f===void 0?"":f,m=t.size,h=m===void 0?a:m,v=t.disabled,b=v===void 0?i:v,g=t.form,y=t.colon,T=t.labelAlign,k=t.labelWrap,S=t.labelCol,M=t.wrapperCol,P=t.hideRequiredMark,x=t.layout,D=x===void 0?"horizontal":x,C=t.scrollToFirstError,R=t.requiredMark,O=t.onFinishFailed,E=t.name,L=Uo(t,["prefixCls","className","size","disabled","form","colon","labelAlign","labelWrap","labelCol","wrapperCol","hideRequiredMark","layout","scrollToFirstError","requiredMark","onFinishFailed","name"]),F=d.exports.useMemo(function(){return R!==void 0?R:s&&s.requiredMark!==void 0?s.requiredMark:!P},[P,R,s]),w=y!=null?y:s==null?void 0:s.colon,K=l("form",u),j=V(K,(n={},_(n,"".concat(K,"-").concat(D),!0),_(n,"".concat(K,"-hide-required-mark"),F===!1),_(n,"".concat(K,"-rtl"),o==="rtl"),_(n,"".concat(K,"-").concat(h),h),n),p),q=ir(g),H=G(q,1),N=H[0],$=N.__INTERNAL__;$.name=E;var U=d.exports.useMemo(function(){return{name:E,labelAlign:T,labelCol:S,labelWrap:k,wrapperCol:M,vertical:D==="vertical",colon:w,requiredMark:F,itemRef:$.itemRef,form:N}},[E,T,S,M,D,w,F,N]);d.exports.useImperativeHandle(r,function(){return N});var z=function(X){O==null||O(X);var ie={block:"nearest"};C&&X.errorFields.length&&(Ne(C)==="object"&&(ie=C),N.scrollToField(X.errorFields[0].name,ie))};return d.exports.createElement(mi,{disabled:b},d.exports.createElement(vi,{size:h},d.exports.createElement(et.Provider,{value:U},d.exports.createElement(gi,A({id:E},L,{name:E,onFinishFailed:z,form:N,className:j})))))},Wo=d.exports.forwardRef(Vo),Ko=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};function qo(e){return e?Ne(e)==="object"&&!d.exports.isValidElement(e)?e:{title:e}:null}var Ho=function(t){var r=t.prefixCls,n=t.label,a=t.htmlFor,i=t.labelCol,c=t.labelAlign,l=t.colon,o=t.required,s=t.requiredMark,u=t.tooltip,f=yi("Form"),p=G(f,1),m=p[0];return n?d.exports.createElement(et.Consumer,{key:"label"},function(h){var v,b=h.vertical,g=h.labelAlign,y=h.labelCol,T=h.labelWrap,k=h.colon,S,M=i||y||{},P=c||g,x="".concat(r,"-item-label"),D=V(x,P==="left"&&"".concat(x,"-left"),M.className,_({},"".concat(x,"-wrap"),!!T)),C=n,R=l===!0||k!==!1&&l!==!1,O=R&&!b;O&&typeof n=="string"&&n.trim()!==""&&(C=n.replace(/[:|ï¼š]\s*$/,""));var E=qo(u);if(E){var L=E.icon,F=L===void 0?d.exports.createElement(xi,null):L,w=Ko(E,["icon"]),K=d.exports.createElement(Ci,w,d.exports.cloneElement(F,{className:"".concat(r,"-item-tooltip"),title:""}));C=d.exports.createElement(d.exports.Fragment,null,C,K)}s==="optional"&&!o&&(C=d.exports.createElement(d.exports.Fragment,null,C,d.exports.createElement("span",{className:"".concat(r,"-item-optional"),title:""},(m==null?void 0:m.optional)||((S=bi.Form)===null||S===void 0?void 0:S.optional))));var j=V((v={},_(v,"".concat(r,"-item-required"),o),_(v,"".concat(r,"-item-required-mark-optional"),s==="optional"),_(v,"".concat(r,"-item-no-colon"),!R),v));return d.exports.createElement(tt,A({},M,{className:D}),d.exports.createElement("label",{htmlFor:a,className:j,title:typeof n=="string"?n:""},C))}):null},Jo=Ho,Tn=[];function or(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{key:typeof e=="string"?e:"".concat(r,"-").concat(n),error:e,errorStatus:t}}function kn(e){var t=e.help,r=e.helpStatus,n=e.errors,a=n===void 0?Tn:n,i=e.warnings,c=i===void 0?Tn:i,l=e.className,o=d.exports.useContext(Zt),s=o.prefixCls,u=d.exports.useContext(ke),f=u.getPrefixCls,p="".concat(s,"-item-explain"),m=f(),h=d.exports.useMemo(function(){return t!=null?[or(t,r,"help")]:[].concat(Te(a.map(function(v,b){return or(v,"error","error",b)})),Te(c.map(function(v,b){return or(v,"warning","warning",b)})))},[t,r,a,c]);return d.exports.createElement(Si,A({},Kr,{motionName:"".concat(m,"-show-help"),motionAppear:!1,motionEnter:!1,visible:!!h.length,onLeaveStart:function(b){return b.style.height="auto",{height:b.offsetHeight}}}),function(v){var b=v.className,g=v.style;return d.exports.createElement("div",{className:V(p,b,l),style:g},d.exports.createElement(_i,A({keys:h},Kr,{motionName:"".concat(m,"-show-help-item"),component:!1}),function(y){var T=y.key,k=y.error,S=y.errorStatus,M=y.className,P=y.style;return d.exports.createElement("div",{key:T,role:"alert",className:V(M,_({},"".concat(p,"-").concat(S),S)),style:P},k)}))})}var Yo=function(t){var r=t.prefixCls,n=t.status,a=t.wrapperCol,i=t.children,c=t.errors,l=t.warnings,o=t._internalItemRender,s=t.extra,u=t.help,f="".concat(r,"-item"),p=d.exports.useContext(et),m=a||p.wrapperCol||{},h=V("".concat(f,"-control"),m.className),v=d.exports.useMemo(function(){return A({},p)},[p]);delete v.labelCol,delete v.wrapperCol;var b=d.exports.createElement("div",{className:"".concat(f,"-control-input")},d.exports.createElement("div",{className:"".concat(f,"-control-input-content")},i)),g=d.exports.useMemo(function(){return{prefixCls:r,status:n}},[r,n]),y=d.exports.createElement(Zt.Provider,{value:g},d.exports.createElement(kn,{errors:c,warnings:l,help:u,helpStatus:n,className:"".concat(f,"-explain-connected")})),T=s?d.exports.createElement("div",{className:"".concat(f,"-extra")},s):null,k=o&&o.mark==="pro_table_render"&&o.render?o.render(t,{input:b,errorList:y,extra:T}):d.exports.createElement(d.exports.Fragment,null,b,y,T);return d.exports.createElement(et.Provider,{value:v},d.exports.createElement(tt,A({},m,{className:h}),k))},Xo=Yo;function Qo(e){var t=d.exports.useState(e),r=G(t,2),n=r[0],a=r[1],i=d.exports.useRef(null),c=d.exports.useRef([]),l=d.exports.useRef(!1);d.exports.useEffect(function(){return l.current=!1,function(){l.current=!0,Ze.cancel(i.current),i.current=null}},[]);function o(s){l.current||(i.current===null&&(c.current=[],i.current=Ze(function(){i.current=null,a(function(u){var f=u;return c.current.forEach(function(p){f=p(f)}),f})})),c.current.push(s))}return[n,o]}function En(e){var t=d.exports.useState(e),r=G(t,2),n=r[0],a=r[1];return d.exports.useEffect(function(){var i=setTimeout(function(){a(e)},e.length?0:10);return function(){clearTimeout(i)}},[e]),n}function Zo(){var e=d.exports.useContext(et),t=e.itemRef,r=d.exports.useRef({});function n(a,i){var c=i&&Ne(i)==="object"&&i.ref,l=a.join("_");return(r.current.name!==l||r.current.originRef!==c)&&(r.current.name=l,r.current.originRef=c,r.current.ref=Ti(t(a),c)),r.current.ref}return n}var es=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},ts="__SPLIT__";Qt("success","warning","error","validating","");var rs=d.exports.memo(function(e){var t=e.children;return t},function(e,t){return e.value===t.value&&e.update===t.update});function ns(e){return e!=null}function Pn(){return{errors:[],warnings:[],touched:!1,validating:!1,name:[]}}var as={success:Ii,warning:Mi,error:Ni,validating:ji};function is(e){var t=e.name,r=e.noStyle,n=e.dependencies,a=e.prefixCls,i=e.style,c=e.className,l=e.shouldUpdate,o=e.hasFeedback,s=e.help,u=e.rules,f=e.validateStatus,p=e.children,m=e.required,h=e.label,v=e.messageVariables,b=e.trigger,g=b===void 0?"onChange":b,y=e.validateTrigger,T=e.hidden,k=es(e,["name","noStyle","dependencies","prefixCls","style","className","shouldUpdate","hasFeedback","help","rules","validateStatus","children","required","label","messageVariables","trigger","validateTrigger","hidden"]),S=d.exports.useContext(ke),M=S.getPrefixCls,P=d.exports.useContext(et),x=P.name,D=P.requiredMark,C=typeof p=="function",R=d.exports.useContext(Yr),O=d.exports.useContext(ki),E=O.validateTrigger,L=y!==void 0?y:E,F=ns(t),w=M("form",a),K=d.exports.useContext(Ei),j=d.exports.useRef(),q=Qo({}),H=G(q,2),N=H[0],$=H[1],U=Pi(function(){return Pn()}),z=G(U,2),W=z[0],X=z[1],ie=function(ee){var ge=K==null?void 0:K.getKey(ee.name);if(X(ee.destroy?Pn():ee,!0),r&&R){var ae=ee.name;if(ee.destroy)ae=j.current||ae;else if(ge!==void 0){var _e=G(ge,2),Ge=_e[0],ye=_e[1];ae=[Ge].concat(Te(ye)),j.current=ae}R(ee,ae)}},Re=function(ee,ge){$(function(ae){var _e=A({},ae),Ge=[].concat(Te(ee.name.slice(0,-1)),Te(ge)),ye=Ge.join(ts);return ee.destroy?delete _e[ye]:_e[ye]=ee,_e})},re=d.exports.useMemo(function(){var ve=Te(W.errors),ee=Te(W.warnings);return Object.values(N).forEach(function(ge){ve.push.apply(ve,Te(ge.errors||[])),ee.push.apply(ee,Te(ge.warnings||[]))}),[ve,ee]},[N,W.errors,W.warnings]),J=G(re,2),ne=J[0],he=J[1],je=En(ne),Be=En(he),se=Zo(),ce="";f!==void 0?ce=f:(W==null?void 0:W.validating)?ce="validating":je.length?ce="error":Be.length?ce="warning":(W==null?void 0:W.touched)&&(ce="success");var le=d.exports.useMemo(function(){var ve;if(o){var ee=ce&&as[ce];ve=ee?d.exports.createElement("span",{className:V("".concat(w,"-item-feedback-icon"),"".concat(w,"-item-feedback-icon-").concat(ce))},d.exports.createElement(ee,null)):null}return{status:ce,hasFeedback:o,feedbackIcon:ve,isFormItemInput:!0}},[ce,o]);function Oe(ve,ee,ge){var ae;if(r&&!T)return ve;var _e=(ae={},_(ae,"".concat(w,"-item"),!0),_(ae,"".concat(w,"-item-with-help"),s!=null||je.length||Be.length),_(ae,"".concat(c),!!c),_(ae,"".concat(w,"-item-has-feedback"),ce&&o),_(ae,"".concat(w,"-item-has-success"),ce==="success"),_(ae,"".concat(w,"-item-has-warning"),ce==="warning"),_(ae,"".concat(w,"-item-has-error"),ce==="error"),_(ae,"".concat(w,"-item-is-validating"),ce==="validating"),_(ae,"".concat(w,"-item-hidden"),T),ae);return d.exports.createElement(Dt,A({className:V(_e),style:i,key:"row"},ht(k,["colon","extra","fieldKey","requiredMark","getValueFromEvent","getValueProps","htmlFor","id","initialValue","isListField","labelAlign","labelWrap","labelCol","normalize","preserve","tooltip","validateFirst","valuePropName","wrapperCol","_internalItemRender"])),d.exports.createElement(Jo,A({htmlFor:ee,required:ge,requiredMark:D},e,{prefixCls:w})),d.exports.createElement(Xo,A({},e,W,{errors:je,warnings:Be,prefixCls:w,status:ce,help:s}),d.exports.createElement(Yr.Provider,{value:Re},d.exports.createElement(zi.Provider,{value:le},ve))))}if(!F&&!C&&!n)return Oe(p);var Me={};return typeof h=="string"?Me.label=h:t&&(Me.label=String(t)),v&&(Me=A(A({},Me),v)),d.exports.createElement(Ri,A({},e,{messageVariables:Me,trigger:g,validateTrigger:L,onMetaChange:ie}),function(ve,ee,ge){var ae=mt(t).length&&ee?ee.name:[],_e=Sn(ae,x),Ge=m!==void 0?m:!!(u&&u.some(function(de){if(de&&Ne(de)==="object"&&de.required&&!de.warningOnly)return!0;if(typeof de=="function"){var fe=de(ge);return fe&&fe.required&&!fe.warningOnly}return!1})),ye=A({},ve),Ue=null;if(Array.isArray(p)&&F)Ue=p;else if(!(C&&(!(l||n)||F))){if(!(n&&!C&&!F))if(Oi(p)){var oe=A(A({},p.props),ye);oe.id||(oe.id=_e),Di(p)&&(oe.ref=se(ae,p));var ue=new Set([].concat(Te(mt(g)),Te(mt(L))));ue.forEach(function(de){oe[de]=function(){for(var fe,qe,Ye,st,ct,lt=arguments.length,He=new Array(lt),Xe=0;Xe<lt;Xe++)He[Xe]=arguments[Xe];(Ye=ye[de])===null||Ye===void 0||(fe=Ye).call.apply(fe,[ye].concat(He)),(ct=(st=p.props)[de])===null||ct===void 0||(qe=ct).call.apply(qe,[st].concat(He))}}),Ue=d.exports.createElement(rs,{value:ye[e.valuePropName||"value"],update:p},qr(p,oe))}else C&&(l||n)&&!F?Ue=p(ge):Ue=p}return Oe(Ue,_e,Ge)})}var os=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},ss=function(t){var r=t.prefixCls,n=t.children,a=os(t,["prefixCls","children"]),i=d.exports.useContext(ke),c=i.getPrefixCls,l=c("form",r),o=d.exports.useMemo(function(){return{prefixCls:l,status:"error"}},[l]);return d.exports.createElement(Ai,a,function(s,u,f){return d.exports.createElement(Zt.Provider,{value:o},n(s.map(function(p){return A(A({},p),{fieldKey:p.key})}),u,{errors:f.errors,warnings:f.warnings}))})},cs=ss;function ls(){var e=d.exports.useContext(et),t=e.form;return t}var Ve=Wo;Ve.Item=is;Ve.List=cs;Ve.ErrorList=kn;Ve.useForm=ir;Ve.useFormInstance=ls;Ve.useWatch=Fi;Ve.Provider=Gi;Ve.create=function(){};var sr=Ve,Rn=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},us=function(t){var r=t.prefixCls,n=t.className,a=t.avatar,i=t.title,c=t.description,l=Rn(t,["prefixCls","className","avatar","title","description"]),o=d.exports.useContext(ke),s=o.getPrefixCls,u=s("list",r),f=V("".concat(u,"-item-meta"),n),p=Le("div",{className:"".concat(u,"-item-meta-content"),children:[i&&Y("h4",{className:"".concat(u,"-item-meta-title"),children:i}),c&&Y("div",{className:"".concat(u,"-item-meta-description"),children:c})]});return Le("div",Yt(pt({},l),{className:f,children:[a&&Y("div",{className:"".concat(u,"-item-meta-avatar"),children:a}),(i||c)&&p]}))},fs=function(t,r){var n=t.prefixCls,a=t.children,i=t.actions,c=t.extra,l=t.className,o=t.colStyle,s=Rn(t,["prefixCls","children","actions","extra","className","colStyle"]),u=d.exports.useContext(cr),f=u.grid,p=u.itemLayout,m=d.exports.useContext(ke),h=m.getPrefixCls,v=function(){var M;return d.exports.Children.forEach(a,function(P){typeof P=="string"&&(M=!0)}),M&&d.exports.Children.count(a)>1},b=function(){return p==="vertical"?!!c:!v()},g=h("list",n),y=i&&i.length>0&&Y("ul",{className:"".concat(g,"-item-action"),children:i.map(function(S,M){return Le("li",{children:[S,M!==i.length-1&&Y("em",{className:"".concat(g,"-item-action-split")})]},"".concat(g,"-item-action-").concat(M))})},"actions"),T=f?"div":"li",k=Y(T,Yt(pt(pt({},s),f?{}:{ref:r}),{className:V("".concat(g,"-item"),_({},"".concat(g,"-item-no-flex"),!b()),l),children:p==="vertical"&&c?[Le("div",{className:"".concat(g,"-item-main"),children:[a,y]},"content"),Y("div",{className:"".concat(g,"-item-extra"),children:c},"extra")]:[a,y,qr(c,{key:"extra"})]}));return f?Y(tt,{ref:r,flex:1,style:o,children:k}):k},On=d.exports.forwardRef(fs);On.Meta=us;var ds=On,ps=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},cr=d.exports.createContext({});cr.Consumer;function Dn(e){var t,r=e.pagination,n=r===void 0?!1:r,a=e.prefixCls,i=e.bordered,c=i===void 0?!1:i,l=e.split,o=l===void 0?!0:l,s=e.className,u=e.children,f=e.itemLayout,p=e.loadMore,m=e.grid,h=e.dataSource,v=h===void 0?[]:h,b=e.size,g=e.header,y=e.footer,T=e.loading,k=T===void 0?!1:T,S=e.rowKey,M=e.renderItem,P=e.locale,x=ps(e,["pagination","prefixCls","bordered","split","className","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]),D=n&&Ne(n)==="object"?n:{},C=d.exports.useState(D.defaultCurrent||1),R=G(C,2),O=R[0],E=R[1],L=d.exports.useState(D.defaultPageSize||10),F=G(L,2),w=F[0],K=F[1],j=d.exports.useContext(ke),q=j.getPrefixCls,H=j.renderEmpty,N=j.direction,$={current:1,total:0},U={},z=function(ue){return function(de,fe){E(de),K(fe),n&&n[ue]&&n[ue](de,fe)}},W=z("onChange"),X=z("onShowSizeChange"),ie=function(ue,de){if(!M)return null;var fe;return typeof S=="function"?fe=S(ue):S?fe=ue[S]:fe=ue.key,fe||(fe="list-item-".concat(de)),U[de]=fe,M(ue,de)},Re=function(){return!!(p||n||y)},re=function(ue,de){return d.exports.createElement("div",{className:"".concat(ue,"-empty-text")},P&&P.emptyText||de("List"))},J=q("list",a),ne=k;typeof ne=="boolean"&&(ne={spinning:ne});var he=ne&&ne.spinning,je="";switch(b){case"large":je="lg";break;case"small":je="sm";break}var Be=V(J,(t={},_(t,"".concat(J,"-vertical"),f==="vertical"),_(t,"".concat(J,"-").concat(je),je),_(t,"".concat(J,"-split"),o),_(t,"".concat(J,"-bordered"),c),_(t,"".concat(J,"-loading"),he),_(t,"".concat(J,"-grid"),!!m),_(t,"".concat(J,"-something-after-last-item"),Re()),_(t,"".concat(J,"-rtl"),N==="rtl"),t),s),se=A(A(A({},$),{total:v.length,current:O,pageSize:w}),n||{}),ce=Math.ceil(se.total/se.pageSize);se.current>ce&&(se.current=ce);var le=n?d.exports.createElement("div",{className:"".concat(J,"-pagination")},d.exports.createElement($i,A({},se,{onChange:W,onShowSizeChange:X}))):null,Oe=Te(v);n&&v.length>(se.current-1)*se.pageSize&&(Oe=Te(v).splice((se.current-1)*se.pageSize,se.pageSize));var Me=Object.keys(m||{}).some(function(oe){return["xs","sm","md","lg","xl","xxl"].includes(oe)}),ve=Li(Me),ee=d.exports.useMemo(function(){for(var oe=0;oe<kt.length;oe+=1){var ue=kt[oe];if(ve[ue])return ue}},[ve]),ge=d.exports.useMemo(function(){if(!!m){var oe=ee&&m[ee]?m[ee]:m.column;if(oe)return{width:"".concat(100/oe,"%"),maxWidth:"".concat(100/oe,"%")}}},[m==null?void 0:m.column,ee]),ae=he&&d.exports.createElement("div",{style:{minHeight:53}});if(Oe.length>0){var _e=Oe.map(function(oe,ue){return ie(oe,ue)}),Ge=d.exports.Children.map(_e,function(oe,ue){return d.exports.createElement("div",{key:U[ue],style:ge},oe)});ae=m?d.exports.createElement(Dt,{gutter:m.gutter},Ge):d.exports.createElement("ul",{className:"".concat(J,"-items")},_e)}else!u&&!he&&(ae=re(J,H||Ui));var ye=se.position||"bottom",Ue=d.exports.useMemo(function(){return{grid:m,itemLayout:f}},[JSON.stringify(m),f]);return d.exports.createElement(cr.Provider,{value:Ue},d.exports.createElement("div",A({className:Be},x),(ye==="top"||ye==="both")&&le,g&&d.exports.createElement("div",{className:"".concat(J,"-header")},g),d.exports.createElement(wi,ne,ae,u),y&&d.exports.createElement("div",{className:"".concat(J,"-footer")},y),p||(ye==="bottom"||ye==="both")&&le))}Dn.Item=ds;var lr={exports:{}};(function(e){var t={};t.useBlobBuilder=function(){try{return new Blob([]),!1}catch{return!0}}(),t.useArrayBufferView=!t.useBlobBuilder&&function(){try{return new Blob([new Uint8Array([])]).size===0}catch{return!0}}(),e.exports.binaryFeatures=t;var r=e.exports.BlobBuilder;typeof window!="undefined"&&(r=e.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder);function n(){this._pieces=[],this._parts=[]}n.prototype.append=function(a){typeof a=="number"?this._pieces.push(a):(this.flush(),this._parts.push(a))},n.prototype.flush=function(){if(this._pieces.length>0){var a=new Uint8Array(this._pieces);t.useArrayBufferView||(a=a.buffer),this._parts.push(a),this._pieces=[]}},n.prototype.getBuffer=function(){if(this.flush(),t.useBlobBuilder){for(var a=new r,i=0,c=this._parts.length;i<c;i++)a.append(this._parts[i]);return a.getBlob()}else return new Blob(this._parts)},e.exports.BufferBuilder=n})(lr);var hs=lr.exports.BufferBuilder,In=lr.exports.binaryFeatures,ms={unpack:function(e){var t=new be(e);return t.unpack()},pack:function(e){var t=new Ce;t.pack(e);var r=t.getBuffer();return r}},Mn=ms;function be(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}be.prototype.unpack=function(){var e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;var t;if((t=e^160)<=15)return this.unpack_raw(t);if((t=e^176)<=15)return this.unpack_string(t);if((t=e^144)<=15)return this.unpack_array(t);if((t=e^128)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}};be.prototype.unpack_uint8=function(){var e=this.dataView[this.index]&255;return this.index++,e};be.prototype.unpack_uint16=function(){var e=this.read(2),t=(e[0]&255)*256+(e[1]&255);return this.index+=2,t};be.prototype.unpack_uint32=function(){var e=this.read(4),t=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,t};be.prototype.unpack_uint64=function(){var e=this.read(8),t=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,t};be.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-(1<<8)};be.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-(1<<16)};be.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)};be.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)};be.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t};be.prototype.unpack_string=function(e){for(var t=this.read(e),r=0,n="",a,i;r<e;)a=t[r],a<128?(n+=String.fromCharCode(a),r++):(a^192)<32?(i=(a^192)<<6|t[r+1]&63,n+=String.fromCharCode(i),r+=2):(i=(a&15)<<12|(t[r+1]&63)<<6|t[r+2]&63,n+=String.fromCharCode(i),r+=3);return this.index+=e,n};be.prototype.unpack_array=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=this.unpack();return t};be.prototype.unpack_map=function(e){for(var t={},r=0;r<e;r++){var n=this.unpack(),a=this.unpack();t[n]=a}return t};be.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=e>>31,r=(e>>23&255)-127,n=e&8388607|8388608;return(t===0?1:-1)*n*Math.pow(2,r-23)};be.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),r=e>>31,n=(e>>20&2047)-1023,a=e&1048575|1048576,i=a*Math.pow(2,n-20)+t*Math.pow(2,n-52);return(r===0?1:-1)*i};be.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")};function Ce(){this.bufferBuilder=new hs}Ce.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()};Ce.prototype.pack=function(e){var t=typeof e;if(t==="string")this.pack_string(e);else if(t==="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(t==="boolean")e===!0?this.bufferBuilder.append(195):e===!1&&this.bufferBuilder.append(194);else if(t==="undefined")this.bufferBuilder.append(192);else if(t==="object")if(e===null)this.bufferBuilder.append(192);else{var r=e.constructor;if(r==Array)this.pack_array(e);else if(r==Blob||r==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(r==ArrayBuffer)In.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)In.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(r==Object||r.toString().startsWith("class"))this.pack_object(e);else if(r==Date)this.pack_string(e.toString());else if(typeof e.toBinaryPack=="function")this.bufferBuilder.append(e.toBinaryPack());else throw new Error('Type "'+r.toString()+'" not yet supported')}else throw new Error('Type "'+t+'" not yet supported');this.bufferBuilder.flush()};Ce.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else if(t<=4294967295)this.bufferBuilder.append(219),this.pack_uint32(t);else throw new Error("Invalid length");this.bufferBuilder.append(e)};Ce.prototype.pack_string=function(e){var t=gs(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else if(t<=4294967295)this.bufferBuilder.append(217),this.pack_uint32(t);else throw new Error("Invalid length");this.bufferBuilder.append(e)};Ce.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else if(t<=4294967295)this.bufferBuilder.append(221),this.pack_uint32(t);else throw new Error("Invalid length");for(var r=0;r<t;r++)this.pack(e[r])};Ce.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(e&255);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this.bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this.bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")};Ce.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var r=Math.floor(Math.log(e)/Math.LN2),n=e/Math.pow(2,r)-1,a=Math.floor(n*Math.pow(2,52)),i=Math.pow(2,32),c=t<<31|r+1023<<20|a/i&1048575,l=a%i;this.bufferBuilder.append(203),this.pack_int32(c),this.pack_int32(l)};Ce.prototype.pack_object=function(e){var t=Object.keys(e),r=t.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this.bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this.bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))};Ce.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)};Ce.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(e&255)};Ce.prototype.pack_uint32=function(e){var t=e&4294967295;this.bufferBuilder.append((t&4278190080)>>>24),this.bufferBuilder.append((t&16711680)>>>16),this.bufferBuilder.append((t&65280)>>>8),this.bufferBuilder.append(t&255)};Ce.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),r=e%Math.pow(2,32);this.bufferBuilder.append((t&4278190080)>>>24),this.bufferBuilder.append((t&16711680)>>>16),this.bufferBuilder.append((t&65280)>>>8),this.bufferBuilder.append(t&255),this.bufferBuilder.append((r&4278190080)>>>24),this.bufferBuilder.append((r&16711680)>>>16),this.bufferBuilder.append((r&65280)>>>8),this.bufferBuilder.append(r&255)};Ce.prototype.pack_int8=function(e){this.bufferBuilder.append(e&255)};Ce.prototype.pack_int16=function(e){this.bufferBuilder.append((e&65280)>>8),this.bufferBuilder.append(e&255)};Ce.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((e&16711680)>>>16),this.bufferBuilder.append((e&65280)>>>8),this.bufferBuilder.append(e&255)};Ce.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),r=e%Math.pow(2,32);this.bufferBuilder.append((t&4278190080)>>>24),this.bufferBuilder.append((t&16711680)>>>16),this.bufferBuilder.append((t&65280)>>>8),this.bufferBuilder.append(t&255),this.bufferBuilder.append((r&4278190080)>>>24),this.bufferBuilder.append((r&16711680)>>>16),this.bufferBuilder.append((r&65280)>>>8),this.bufferBuilder.append(r&255)};function vs(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}function gs(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,vs).length}let Nn=!0,jn=!0;function vt(e,t,r){const n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function it(e,t,r){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,a=n.addEventListener;n.addEventListener=function(c,l){if(c!==t)return a.apply(this,arguments);const o=s=>{const u=r(s);u&&(l.handleEvent?l.handleEvent(u):l(u))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(l,o),a.apply(this,[c,o])};const i=n.removeEventListener;n.removeEventListener=function(c,l){if(c!==t||!this._eventMap||!this._eventMap[t])return i.apply(this,arguments);if(!this._eventMap[t].has(l))return i.apply(this,arguments);const o=this._eventMap[t].get(l);return this._eventMap[t].delete(l),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,i.apply(this,[c,o])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(c){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),c&&this.addEventListener(t,this["_on"+t]=c)},enumerable:!0,configurable:!0})}function ys(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(Nn=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function bs(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(jn=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function ur(){if(typeof window=="object"){if(Nn)return;typeof console!="undefined"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Mt(e,t){!jn||console.warn(e+" is deprecated, please use "+t+" instead.")}function Cs(e){const t={browser:null,version:null};if(typeof e=="undefined"||!e.navigator)return t.browser="Not a browser.",t;const{navigator:r}=e;if(r.mozGetUserMedia)t.browser="firefox",t.version=vt(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=vt(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(r.mediaDevices&&r.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=vt(r.userAgent,/Edge\/(\d+).(\d+)$/,2);else if(e.RTCPeerConnection&&r.userAgent.match(/AppleWebKit\/(\d+)\./))t.browser="safari",t.version=vt(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype;else return t.browser="Not a supported browser.",t;return t}function An(e){return Object.prototype.toString.call(e)==="[object Object]"}function Fn(e){return An(e)?Object.keys(e).reduce(function(t,r){const n=An(e[r]),a=n?Fn(e[r]):e[r],i=n&&!Object.keys(a).length;return a===void 0||i?t:Object.assign(t,{[r]:a})},{}):e}function fr(e,t,r){!t||r.has(t.id)||(r.set(t.id,t),Object.keys(t).forEach(n=>{n.endsWith("Id")?fr(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach(a=>{fr(e,e.get(a),r)})}))}function Ln(e,t,r){const n=r?"outbound-rtp":"inbound-rtp",a=new Map;if(t===null)return a;const i=[];return e.forEach(c=>{c.type==="track"&&c.trackIdentifier===t.id&&i.push(c)}),i.forEach(c=>{e.forEach(l=>{l.type===n&&l.trackId===c.id&&fr(e,l,a)})}),a}const Bn=ur;function $n(e,t){const r=e&&e.navigator;if(!r.mediaDevices)return;const n=function(l){if(typeof l!="object"||l.mandatory||l.optional)return l;const o={};return Object.keys(l).forEach(s=>{if(s==="require"||s==="advanced"||s==="mediaSource")return;const u=typeof l[s]=="object"?l[s]:{ideal:l[s]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const f=function(p,m){return p?p+m.charAt(0).toUpperCase()+m.slice(1):m==="deviceId"?"sourceId":m};if(u.ideal!==void 0){o.optional=o.optional||[];let p={};typeof u.ideal=="number"?(p[f("min",s)]=u.ideal,o.optional.push(p),p={},p[f("max",s)]=u.ideal,o.optional.push(p)):(p[f("",s)]=u.ideal,o.optional.push(p))}u.exact!==void 0&&typeof u.exact!="number"?(o.mandatory=o.mandatory||{},o.mandatory[f("",s)]=u.exact):["min","max"].forEach(p=>{u[p]!==void 0&&(o.mandatory=o.mandatory||{},o.mandatory[f(p,s)]=u[p])})}),l.advanced&&(o.optional=(o.optional||[]).concat(l.advanced)),o},a=function(l,o){if(t.version>=61)return o(l);if(l=JSON.parse(JSON.stringify(l)),l&&typeof l.audio=="object"){const s=function(u,f,p){f in u&&!(p in u)&&(u[p]=u[f],delete u[f])};l=JSON.parse(JSON.stringify(l)),s(l.audio,"autoGainControl","googAutoGainControl"),s(l.audio,"noiseSuppression","googNoiseSuppression"),l.audio=n(l.audio)}if(l&&typeof l.video=="object"){let s=l.video.facingMode;s=s&&(typeof s=="object"?s:{ideal:s});const u=t.version<66;if(s&&(s.exact==="user"||s.exact==="environment"||s.ideal==="user"||s.ideal==="environment")&&!(r.mediaDevices.getSupportedConstraints&&r.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete l.video.facingMode;let f;if(s.exact==="environment"||s.ideal==="environment"?f=["back","rear"]:(s.exact==="user"||s.ideal==="user")&&(f=["front"]),f)return r.mediaDevices.enumerateDevices().then(p=>{p=p.filter(h=>h.kind==="videoinput");let m=p.find(h=>f.some(v=>h.label.toLowerCase().includes(v)));return!m&&p.length&&f.includes("back")&&(m=p[p.length-1]),m&&(l.video.deviceId=s.exact?{exact:m.deviceId}:{ideal:m.deviceId}),l.video=n(l.video),Bn("chrome: "+JSON.stringify(l)),o(l)})}l.video=n(l.video)}return Bn("chrome: "+JSON.stringify(l)),o(l)},i=function(l){return t.version>=64?l:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[l.name]||l.name,message:l.message,constraint:l.constraint||l.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},c=function(l,o,s){a(l,u=>{r.webkitGetUserMedia(u,o,f=>{s&&s(i(f))})})};if(r.getUserMedia=c.bind(r),r.mediaDevices.getUserMedia){const l=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(o){return a(o,s=>l(s).then(u=>{if(s.audio&&!u.getAudioTracks().length||s.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(f=>{f.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(i(u))))}}}function xs(e,t){if(!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&!!e.navigator.mediaDevices){if(typeof t!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(a=>{const i=n.video&&n.video.width,c=n.video&&n.video.height,l=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:l||3}},i&&(n.video.mandatory.maxWidth=i),c&&(n.video.mandatory.maxHeight=c),e.navigator.mediaDevices.getUserMedia(n)})}}}function wn(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function zn(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",a=>{let i;e.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(l=>l.track&&l.track.id===a.track.id):i={track:a.track};const c=new Event("track");c.track=a.track,c.receiver=i,c.transceiver={receiver:i},c.streams=[n.stream],this.dispatchEvent(c)}),n.stream.getTracks().forEach(a=>{let i;e.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(l=>l.track&&l.track.id===a.id):i={track:a};const c=new Event("track");c.track=a,c.receiver=i,c.transceiver={receiver:i},c.streams=[n.stream],this.dispatchEvent(c)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else it(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function Gn(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(a,i){return{track:i,get dtmf(){return this._dtmf===void 0&&(i.kind==="audio"?this._dtmf=a.createDTMFSender(i):this._dtmf=null),this._dtmf},_pc:a}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const a=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(l,o){let s=a.apply(this,arguments);return s||(s=t(this,l),this._senders.push(s)),s};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(l){i.apply(this,arguments);const o=this._senders.indexOf(l);o!==-1&&this._senders.splice(o,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(i){this._senders=this._senders||[],r.apply(this,[i]),i.getTracks().forEach(c=>{this._senders.push(t(this,c))})};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(i){this._senders=this._senders||[],n.apply(this,[i]),i.getTracks().forEach(c=>{const l=this._senders.find(o=>o.track===c);l&&this._senders.splice(this._senders.indexOf(l),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const n=t.apply(this,[]);return n.forEach(a=>a._pc=this),n},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Un(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[n,a,i]=arguments;if(arguments.length>0&&typeof n=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof n!="function"))return t.apply(this,[]);const c=function(o){const s={};return o.result().forEach(f=>{const p={id:f.id,timestamp:f.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[f.type]||f.type};f.names().forEach(m=>{p[m]=f.stat(m)}),s[p.id]=p}),s},l=function(o){return new Map(Object.keys(o).map(s=>[s,o[s]]))};if(arguments.length>=2){const o=function(s){a(l(c(s)))};return t.apply(this,[o,n])}return new Promise((o,s)=>{t.apply(this,[function(u){o(l(c(u)))},s])}).then(a,i)}}function Vn(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=r.apply(this,[]);return i.forEach(c=>c._pc=this),i});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){const i=this;return this._pc.getStats().then(c=>Ln(c,i.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){const a=r.apply(this,[]);return a.forEach(i=>i._pc=this),a}),it(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){const a=this;return this._pc.getStats().then(i=>Ln(i,a.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const n=arguments[0];let a,i,c;return this.getSenders().forEach(l=>{l.track===n&&(a?c=!0:a=l)}),this.getReceivers().forEach(l=>(l.track===n&&(i?c=!0:i=l),l.track===n)),c||a&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):a?a.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Wn(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(c=>this._shimmedLocalStreams[c][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(c,l){if(!l)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const o=t.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(o)===-1&&this._shimmedLocalStreams[l.id].push(o):this._shimmedLocalStreams[l.id]=[l,o],o};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(c){this._shimmedLocalStreams=this._shimmedLocalStreams||{},c.getTracks().forEach(s=>{if(this.getSenders().find(f=>f.track===s))throw new DOMException("Track already exists.","InvalidAccessError")});const l=this.getSenders();r.apply(this,arguments);const o=this.getSenders().filter(s=>l.indexOf(s)===-1);this._shimmedLocalStreams[c.id]=[c].concat(o)};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[c.id],n.apply(this,arguments)};const a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},c&&Object.keys(this._shimmedLocalStreams).forEach(l=>{const o=this._shimmedLocalStreams[l].indexOf(c);o!==-1&&this._shimmedLocalStreams[l].splice(o,1),this._shimmedLocalStreams[l].length===1&&delete this._shimmedLocalStreams[l]}),a.apply(this,arguments)}}function Kn(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Wn(e);const r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const u=r.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(f=>this._reverseStreams[f.id])};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(f=>{if(this.getSenders().find(m=>m.track===f))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const f=new e.MediaStream(u.getTracks());this._streams[u.id]=f,this._reverseStreams[f.id]=u,u=f}n.apply(this,[u])};const a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},e.RTCPeerConnection.prototype.addTrack=function(u,f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const p=[].slice.call(arguments,1);if(p.length!==1||!p[0].getTracks().find(v=>v===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(v=>v.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const h=this._streams[f.id];if(h)h.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const v=new e.MediaStream([u]);this._streams[f.id]=v,this._reverseStreams[v.id]=f,this.addStream(v)}return this.getSenders().find(v=>v.track===u)};function i(s,u){let f=u.sdp;return Object.keys(s._reverseStreams||[]).forEach(p=>{const m=s._reverseStreams[p],h=s._streams[m.id];f=f.replace(new RegExp(h.id,"g"),m.id)}),new RTCSessionDescription({type:u.type,sdp:f})}function c(s,u){let f=u.sdp;return Object.keys(s._reverseStreams||[]).forEach(p=>{const m=s._reverseStreams[p],h=s._streams[m.id];f=f.replace(new RegExp(m.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:f})}["createOffer","createAnswer"].forEach(function(s){const u=e.RTCPeerConnection.prototype[s],f={[s](){const p=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[h=>{const v=i(this,h);p[0].apply(null,[v])},h=>{p[1]&&p[1].apply(null,h)},arguments[2]]):u.apply(this,arguments).then(h=>i(this,h))}};e.RTCPeerConnection.prototype[s]=f[s]});const l=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?l.apply(this,arguments):(arguments[0]=c(this,arguments[0]),l.apply(this,arguments))};const o=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const s=o.get.apply(this);return s.type===""?s:i(this,s)}}),e.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let p;Object.keys(this._streams).forEach(m=>{this._streams[m].getTracks().find(v=>u.track===v)&&(p=this._streams[m])}),p&&(p.getTracks().length===1?this.removeStream(this._reverseStreams[p.id]):p.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function dr(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),!!e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const n=e.RTCPeerConnection.prototype[r],a={[r](){return arguments[0]=new(r==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[r]=a[r]})}function qn(e,t){it(e,"negotiationneeded",r=>{const n=r.target;if(!((t.version<72||n.getConfiguration&&n.getConfiguration().sdpSemantics==="plan-b")&&n.signalingState!=="stable"))return r})}var Hn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",shimMediaStream:wn,shimOnTrack:zn,shimGetSendersWithDtmf:Gn,shimGetStats:Un,shimSenderReceiverGetStats:Vn,shimAddTrackRemoveTrackWithNative:Wn,shimAddTrackRemoveTrack:Kn,shimPeerConnection:dr,fixNegotiationNeeded:qn,shimGetUserMedia:$n,shimGetDisplayMedia:xs});function Ss(e,t){let r=!1;return e=JSON.parse(JSON.stringify(e)),e.filter(n=>{if(n&&(n.urls||n.url)){let a=n.urls||n.url;n.url&&!n.urls&&Mt("RTCIceServer.url","RTCIceServer.urls");const i=typeof a=="string";return i&&(a=[a]),a=a.filter(c=>{if(c.indexOf("stun:")===0)return!1;const l=c.startsWith("turn")&&!c.startsWith("turn:[")&&c.includes("transport=udp");return l&&!r?(r=!0,!0):l&&!r}),delete n.url,n.urls=i?a[0]:a,!!a.length}})}var pr={exports:{}};(function(e){var t={};t.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},t.localCName=t.generateIdentifier(),t.splitLines=function(r){return r.trim().split(`
`).map(function(n){return n.trim()})},t.splitSections=function(r){var n=r.split(`
m=`);return n.map(function(a,i){return(i>0?"m="+a:a).trim()+`\r
`})},t.getDescription=function(r){var n=t.splitSections(r);return n&&n[0]},t.getMediaSections=function(r){var n=t.splitSections(r);return n.shift(),n},t.matchPrefix=function(r,n){return t.splitLines(r).filter(function(a){return a.indexOf(n)===0})},t.parseCandidate=function(r){var n;r.indexOf("a=candidate:")===0?n=r.substring(12).split(" "):n=r.substring(10).split(" ");for(var a={foundation:n[0],component:parseInt(n[1],10),protocol:n[2].toLowerCase(),priority:parseInt(n[3],10),ip:n[4],address:n[4],port:parseInt(n[5],10),type:n[7]},i=8;i<n.length;i+=2)switch(n[i]){case"raddr":a.relatedAddress=n[i+1];break;case"rport":a.relatedPort=parseInt(n[i+1],10);break;case"tcptype":a.tcpType=n[i+1];break;case"ufrag":a.ufrag=n[i+1],a.usernameFragment=n[i+1];break;default:a[n[i]]=n[i+1];break}return a},t.writeCandidate=function(r){var n=[];n.push(r.foundation),n.push(r.component),n.push(r.protocol.toUpperCase()),n.push(r.priority),n.push(r.address||r.ip),n.push(r.port);var a=r.type;return n.push("typ"),n.push(a),a!=="host"&&r.relatedAddress&&r.relatedPort&&(n.push("raddr"),n.push(r.relatedAddress),n.push("rport"),n.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(n.push("tcptype"),n.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(n.push("ufrag"),n.push(r.usernameFragment||r.ufrag)),"candidate:"+n.join(" ")},t.parseIceOptions=function(r){return r.substr(14).split(" ")},t.parseRtpMap=function(r){var n=r.substr(9).split(" "),a={payloadType:parseInt(n.shift(),10)};return n=n[0].split("/"),a.name=n[0],a.clockRate=parseInt(n[1],10),a.channels=n.length===3?parseInt(n[2],10):1,a.numChannels=a.channels,a},t.writeRtpMap=function(r){var n=r.payloadType;r.preferredPayloadType!==void 0&&(n=r.preferredPayloadType);var a=r.channels||r.numChannels||1;return"a=rtpmap:"+n+" "+r.name+"/"+r.clockRate+(a!==1?"/"+a:"")+`\r
`},t.parseExtmap=function(r){var n=r.substr(9).split(" ");return{id:parseInt(n[0],10),direction:n[0].indexOf("/")>0?n[0].split("/")[1]:"sendrecv",uri:n[1]}},t.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+`\r
`},t.parseFmtp=function(r){for(var n={},a,i=r.substr(r.indexOf(" ")+1).split(";"),c=0;c<i.length;c++)a=i[c].trim().split("="),n[a[0].trim()]=a[1];return n},t.writeFmtp=function(r){var n="",a=r.payloadType;if(r.preferredPayloadType!==void 0&&(a=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){var i=[];Object.keys(r.parameters).forEach(function(c){r.parameters[c]?i.push(c+"="+r.parameters[c]):i.push(c)}),n+="a=fmtp:"+a+" "+i.join(";")+`\r
`}return n},t.parseRtcpFb=function(r){var n=r.substr(r.indexOf(" ")+1).split(" ");return{type:n.shift(),parameter:n.join(" ")}},t.writeRtcpFb=function(r){var n="",a=r.payloadType;return r.preferredPayloadType!==void 0&&(a=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(function(i){n+="a=rtcp-fb:"+a+" "+i.type+(i.parameter&&i.parameter.length?" "+i.parameter:"")+`\r
`}),n},t.parseSsrcMedia=function(r){var n=r.indexOf(" "),a={ssrc:parseInt(r.substr(7,n-7),10)},i=r.indexOf(":",n);return i>-1?(a.attribute=r.substr(n+1,i-n-1),a.value=r.substr(i+1)):a.attribute=r.substr(n+1),a},t.parseSsrcGroup=function(r){var n=r.substr(13).split(" ");return{semantics:n.shift(),ssrcs:n.map(function(a){return parseInt(a,10)})}},t.getMid=function(r){var n=t.matchPrefix(r,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(r){var n=r.substr(14).split(" ");return{algorithm:n[0].toLowerCase(),value:n[1]}},t.getDtlsParameters=function(r,n){var a=t.matchPrefix(r+n,"a=fingerprint:");return{role:"auto",fingerprints:a.map(t.parseFingerprint)}},t.writeDtlsParameters=function(r,n){var a="a=setup:"+n+`\r
`;return r.fingerprints.forEach(function(i){a+="a=fingerprint:"+i.algorithm+" "+i.value+`\r
`}),a},t.parseCryptoLine=function(r){var n=r.substr(9).split(" ");return{tag:parseInt(n[0],10),cryptoSuite:n[1],keyParams:n[2],sessionParams:n.slice(3)}},t.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?t.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;var n=r.substr(7).split("|");return{keyMethod:"inline",keySalt:n[0],lifeTime:n[1],mkiValue:n[2]?n[2].split(":")[0]:void 0,mkiLength:n[2]?n[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},t.getCryptoParameters=function(r,n){var a=t.matchPrefix(r+n,"a=crypto:");return a.map(t.parseCryptoLine)},t.getIceParameters=function(r,n){var a=t.matchPrefix(r+n,"a=ice-ufrag:")[0],i=t.matchPrefix(r+n,"a=ice-pwd:")[0];return a&&i?{usernameFragment:a.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(r){return"a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`},t.parseRtpParameters=function(r){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=t.splitLines(r),i=a[0].split(" "),c=3;c<i.length;c++){var l=i[c],o=t.matchPrefix(r,"a=rtpmap:"+l+" ")[0];if(o){var s=t.parseRtpMap(o),u=t.matchPrefix(r,"a=fmtp:"+l+" ");switch(s.parameters=u.length?t.parseFmtp(u[0]):{},s.rtcpFeedback=t.matchPrefix(r,"a=rtcp-fb:"+l+" ").map(t.parseRtcpFb),n.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(s.name.toUpperCase());break}}}return t.matchPrefix(r,"a=extmap:").forEach(function(f){n.headerExtensions.push(t.parseExtmap(f))}),n},t.writeRtpDescription=function(r,n){var a="";a+="m="+r+" ",a+=n.codecs.length>0?"9":"0",a+=" UDP/TLS/RTP/SAVPF ",a+=n.codecs.map(function(c){return c.preferredPayloadType!==void 0?c.preferredPayloadType:c.payloadType}).join(" ")+`\r
`,a+=`c=IN IP4 0.0.0.0\r
`,a+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,n.codecs.forEach(function(c){a+=t.writeRtpMap(c),a+=t.writeFmtp(c),a+=t.writeRtcpFb(c)});var i=0;return n.codecs.forEach(function(c){c.maxptime>i&&(i=c.maxptime)}),i>0&&(a+="a=maxptime:"+i+`\r
`),a+=`a=rtcp-mux\r
`,n.headerExtensions&&n.headerExtensions.forEach(function(c){a+=t.writeExtmap(c)}),a},t.parseRtpEncodingParameters=function(r){var n=[],a=t.parseRtpParameters(r),i=a.fecMechanisms.indexOf("RED")!==-1,c=a.fecMechanisms.indexOf("ULPFEC")!==-1,l=t.matchPrefix(r,"a=ssrc:").map(function(p){return t.parseSsrcMedia(p)}).filter(function(p){return p.attribute==="cname"}),o=l.length>0&&l[0].ssrc,s,u=t.matchPrefix(r,"a=ssrc-group:FID").map(function(p){var m=p.substr(17).split(" ");return m.map(function(h){return parseInt(h,10)})});u.length>0&&u[0].length>1&&u[0][0]===o&&(s=u[0][1]),a.codecs.forEach(function(p){if(p.name.toUpperCase()==="RTX"&&p.parameters.apt){var m={ssrc:o,codecPayloadType:parseInt(p.parameters.apt,10)};o&&s&&(m.rtx={ssrc:s}),n.push(m),i&&(m=JSON.parse(JSON.stringify(m)),m.fec={ssrc:o,mechanism:c?"red+ulpfec":"red"},n.push(m))}}),n.length===0&&o&&n.push({ssrc:o});var f=t.matchPrefix(r,"b=");return f.length&&(f[0].indexOf("b=TIAS:")===0?f=parseInt(f[0].substr(7),10):f[0].indexOf("b=AS:")===0?f=parseInt(f[0].substr(5),10)*1e3*.95-50*40*8:f=void 0,n.forEach(function(p){p.maxBitrate=f})),n},t.parseRtcpParameters=function(r){var n={},a=t.matchPrefix(r,"a=ssrc:").map(function(l){return t.parseSsrcMedia(l)}).filter(function(l){return l.attribute==="cname"})[0];a&&(n.cname=a.value,n.ssrc=a.ssrc);var i=t.matchPrefix(r,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=i.length===0;var c=t.matchPrefix(r,"a=rtcp-mux");return n.mux=c.length>0,n},t.parseMsid=function(r){var n,a=t.matchPrefix(r,"a=msid:");if(a.length===1)return n=a[0].substr(7).split(" "),{stream:n[0],track:n[1]};var i=t.matchPrefix(r,"a=ssrc:").map(function(c){return t.parseSsrcMedia(c)}).filter(function(c){return c.attribute==="msid"});if(i.length>0)return n=i[0].value.split(" "),{stream:n[0],track:n[1]}},t.parseSctpDescription=function(r){var n=t.parseMLine(r),a=t.matchPrefix(r,"a=max-message-size:"),i;a.length>0&&(i=parseInt(a[0].substr(19),10)),isNaN(i)&&(i=65536);var c=t.matchPrefix(r,"a=sctp-port:");if(c.length>0)return{port:parseInt(c[0].substr(12),10),protocol:n.fmt,maxMessageSize:i};var l=t.matchPrefix(r,"a=sctpmap:");if(l.length>0){var o=t.matchPrefix(r,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(o[0],10),protocol:o[1],maxMessageSize:i}}},t.writeSctpDescription=function(r,n){var a=[];return r.protocol!=="DTLS/SCTP"?a=["m="+r.kind+" 9 "+r.protocol+" "+n.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+n.port+`\r
`]:a=["m="+r.kind+" 9 "+r.protocol+" "+n.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+n.port+" "+n.protocol+` 65535\r
`],n.maxMessageSize!==void 0&&a.push("a=max-message-size:"+n.maxMessageSize+`\r
`),a.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(r,n,a){var i,c=n!==void 0?n:2;r?i=r:i=t.generateSessionId();var l=a||"thisisadapterortc";return`v=0\r
o=`+l+" "+i+" "+c+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.writeMediaSection=function(r,n,a,i){var c=t.writeRtpDescription(r.kind,n);if(c+=t.writeIceParameters(r.iceGatherer.getLocalParameters()),c+=t.writeDtlsParameters(r.dtlsTransport.getLocalParameters(),a==="offer"?"actpass":"active"),c+="a=mid:"+r.mid+`\r
`,r.direction?c+="a="+r.direction+`\r
`:r.rtpSender&&r.rtpReceiver?c+=`a=sendrecv\r
`:r.rtpSender?c+=`a=sendonly\r
`:r.rtpReceiver?c+=`a=recvonly\r
`:c+=`a=inactive\r
`,r.rtpSender){var l="msid:"+i.id+" "+r.rtpSender.track.id+`\r
`;c+="a="+l,c+="a=ssrc:"+r.sendEncodingParameters[0].ssrc+" "+l,r.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+r.sendEncodingParameters[0].rtx.ssrc+" "+l,c+="a=ssrc-group:FID "+r.sendEncodingParameters[0].ssrc+" "+r.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return c+="a=ssrc:"+r.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+`\r
`,r.rtpSender&&r.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+r.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+`\r
`),c},t.getDirection=function(r,n){for(var a=t.splitLines(r),i=0;i<a.length;i++)switch(a[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(r){var n=t.splitLines(r),a=n[0].split(" ");return a[0].substr(2)},t.isRejected=function(r){return r.split(" ",2)[1]==="0"},t.parseMLine=function(r){var n=t.splitLines(r),a=n[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}},t.parseOLine=function(r){var n=t.matchPrefix(r,"o=")[0],a=n.substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}},t.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;for(var n=t.splitLines(r),a=0;a<n.length;a++)if(n[a].length<2||n[a].charAt(1)!=="=")return!1;return!0},e.exports=t})(pr);var Nt=pr.exports,B=pr.exports;function _s(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function Jn(e,t,r,n,a){var i=B.writeRtpDescription(e.kind,t);if(i+=B.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=B.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),r==="offer"?"actpass":a||"active"),i+="a=mid:"+e.mid+`\r
`,e.rtpSender&&e.rtpReceiver?i+=`a=sendrecv\r
`:e.rtpSender?i+=`a=sendonly\r
`:e.rtpReceiver?i+=`a=recvonly\r
`:i+=`a=inactive\r
`,e.rtpSender){var c=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=c;var l="msid:"+(n?n.id:"-")+" "+c+`\r
`;i+="a="+l,i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+l,e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+l,i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+B.localCName+`\r
`,e.rtpSender&&e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+B.localCName+`\r
`),i}function Ts(e,t){var r=!1;return e=JSON.parse(JSON.stringify(e)),e.filter(function(n){if(n&&(n.urls||n.url)){var a=n.urls||n.url;n.url&&!n.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i=typeof a=="string";return i&&(a=[a]),a=a.filter(function(c){var l=c.indexOf("turn:")===0&&c.indexOf("transport=udp")!==-1&&c.indexOf("turn:[")===-1&&!r;return l?(r=!0,!0):c.indexOf("stun:")===0&&t>=14393&&c.indexOf("?transport=udp")===-1}),delete n.url,n.urls=i?a[0]:a,!!a.length}})}function jt(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(i,c){i=parseInt(i,10);for(var l=0;l<c.length;l++)if(c[l].payloadType===i||c[l].preferredPayloadType===i)return c[l]},a=function(i,c,l,o){var s=n(i.parameters.apt,l),u=n(c.parameters.apt,o);return s&&u&&s.name.toLowerCase()===u.name.toLowerCase()};return e.codecs.forEach(function(i){for(var c=0;c<t.codecs.length;c++){var l=t.codecs[c];if(i.name.toLowerCase()===l.name.toLowerCase()&&i.clockRate===l.clockRate){if(i.name.toLowerCase()==="rtx"&&i.parameters&&l.parameters.apt&&!a(i,l,e.codecs,t.codecs))continue;l=JSON.parse(JSON.stringify(l)),l.numChannels=Math.min(i.numChannels,l.numChannels),r.codecs.push(l),l.rtcpFeedback=l.rtcpFeedback.filter(function(o){for(var s=0;s<i.rtcpFeedback.length;s++)if(i.rtcpFeedback[s].type===o.type&&i.rtcpFeedback[s].parameter===o.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(i){for(var c=0;c<t.headerExtensions.length;c++){var l=t.headerExtensions[c];if(i.uri===l.uri){r.headerExtensions.push(l);break}}}),r}function Yn(e,t,r){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)!==-1}function hr(e,t){var r=e.getRemoteCandidates().find(function(n){return t.foundation===n.foundation&&t.ip===n.ip&&t.port===n.port&&t.priority===n.priority&&t.protocol===n.protocol&&t.type===n.type});return r||e.addRemoteCandidate(t),!r}function Ee(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}var ks=function(e,t){function r(o,s){s.addTrack(o),s.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:o}))}function n(o,s){s.removeTrack(o),s.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:o}))}function a(o,s,u,f){var p=new Event("track");p.track=s,p.receiver=u,p.transceiver={receiver:u},p.streams=f,e.setTimeout(function(){o._dispatchEvent("track",p)})}var i=function(o){var s=this,u=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(p){s[p]=u[p].bind(u)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",o=JSON.parse(JSON.stringify(o||{})),this.usingBundle=o.bundlePolicy==="max-bundle",o.rtcpMuxPolicy==="negotiate")throw Ee("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(o.rtcpMuxPolicy||(o.rtcpMuxPolicy="require"),o.iceTransportPolicy){case"all":case"relay":break;default:o.iceTransportPolicy="all";break}switch(o.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:o.bundlePolicy="balanced";break}if(o.iceServers=Ts(o.iceServers||[],t),this._iceGatherers=[],o.iceCandidatePoolSize)for(var f=o.iceCandidatePoolSize;f>0;f--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:o.iceServers,gatherPolicy:o.iceTransportPolicy}));else o.iceCandidatePoolSize=0;this._config=o,this.transceivers=[],this._sdpSessionId=B.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(o,s){this._isClosed||(this.dispatchEvent(s),typeof this["on"+o]=="function"&&this["on"+o](s))},i.prototype._emitGatheringStateChange=function(){var o=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",o)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(o,s){var u=this.transceivers.length>0,f={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:o,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&u)f.iceTransport=this.transceivers[0].iceTransport,f.dtlsTransport=this.transceivers[0].dtlsTransport;else{var p=this._createIceAndDtlsTransports();f.iceTransport=p.iceTransport,f.dtlsTransport=p.dtlsTransport}return s||this.transceivers.push(f),f},i.prototype.addTrack=function(o,s){if(this._isClosed)throw Ee("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var u=this.transceivers.find(function(m){return m.track===o});if(u)throw Ee("InvalidAccessError","Track already exists.");for(var f,p=0;p<this.transceivers.length;p++)!this.transceivers[p].track&&this.transceivers[p].kind===o.kind&&(f=this.transceivers[p]);return f||(f=this._createTransceiver(o.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(s)===-1&&this.localStreams.push(s),f.track=o,f.stream=s,f.rtpSender=new e.RTCRtpSender(o,f.dtlsTransport),f.rtpSender},i.prototype.addStream=function(o){var s=this;if(t>=15025)o.getTracks().forEach(function(f){s.addTrack(f,o)});else{var u=o.clone();o.getTracks().forEach(function(f,p){var m=u.getTracks()[p];f.addEventListener("enabled",function(h){m.enabled=h.enabled})}),u.getTracks().forEach(function(f){s.addTrack(f,u)})}},i.prototype.removeTrack=function(o){if(this._isClosed)throw Ee("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(o instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var s=this.transceivers.find(function(p){return p.rtpSender===o});if(!s)throw Ee("InvalidAccessError","Sender was not created by this connection.");var u=s.stream;s.rtpSender.stop(),s.rtpSender=null,s.track=null,s.stream=null;var f=this.transceivers.map(function(p){return p.stream});f.indexOf(u)===-1&&this.localStreams.indexOf(u)>-1&&this.localStreams.splice(this.localStreams.indexOf(u),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(o){var s=this;o.getTracks().forEach(function(u){var f=s.getSenders().find(function(p){return p.track===u});f&&s.removeTrack(f)})},i.prototype.getSenders=function(){return this.transceivers.filter(function(o){return!!o.rtpSender}).map(function(o){return o.rtpSender})},i.prototype.getReceivers=function(){return this.transceivers.filter(function(o){return!!o.rtpReceiver}).map(function(o){return o.rtpReceiver})},i.prototype._createIceGatherer=function(o,s){var u=this;if(s&&o>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var f=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(f,"state",{value:"new",writable:!0}),this.transceivers[o].bufferedCandidateEvents=[],this.transceivers[o].bufferCandidates=function(p){var m=!p.candidate||Object.keys(p.candidate).length===0;f.state=m?"completed":"gathering",u.transceivers[o].bufferedCandidateEvents!==null&&u.transceivers[o].bufferedCandidateEvents.push(p)},f.addEventListener("localcandidate",this.transceivers[o].bufferCandidates),f},i.prototype._gather=function(o,s){var u=this,f=this.transceivers[s].iceGatherer;if(!f.onlocalcandidate){var p=this.transceivers[s].bufferedCandidateEvents;this.transceivers[s].bufferedCandidateEvents=null,f.removeEventListener("localcandidate",this.transceivers[s].bufferCandidates),f.onlocalcandidate=function(m){if(!(u.usingBundle&&s>0)){var h=new Event("icecandidate");h.candidate={sdpMid:o,sdpMLineIndex:s};var v=m.candidate,b=!v||Object.keys(v).length===0;if(b)(f.state==="new"||f.state==="gathering")&&(f.state="completed");else{f.state==="new"&&(f.state="gathering"),v.component=1,v.ufrag=f.getLocalParameters().usernameFragment;var g=B.writeCandidate(v);h.candidate=Object.assign(h.candidate,B.parseCandidate(g)),h.candidate.candidate=g,h.candidate.toJSON=function(){return{candidate:h.candidate.candidate,sdpMid:h.candidate.sdpMid,sdpMLineIndex:h.candidate.sdpMLineIndex,usernameFragment:h.candidate.usernameFragment}}}var y=B.getMediaSections(u._localDescription.sdp);b?y[h.candidate.sdpMLineIndex]+=`a=end-of-candidates\r
`:y[h.candidate.sdpMLineIndex]+="a="+h.candidate.candidate+`\r
`,u._localDescription.sdp=B.getDescription(u._localDescription.sdp)+y.join("");var T=u.transceivers.every(function(k){return k.iceGatherer&&k.iceGatherer.state==="completed"});u.iceGatheringState!=="gathering"&&(u.iceGatheringState="gathering",u._emitGatheringStateChange()),b||u._dispatchEvent("icecandidate",h),T&&(u._dispatchEvent("icecandidate",new Event("icecandidate")),u.iceGatheringState="complete",u._emitGatheringStateChange())}},e.setTimeout(function(){p.forEach(function(m){f.onlocalcandidate(m)})},0)}},i.prototype._createIceAndDtlsTransports=function(){var o=this,s=new e.RTCIceTransport(null);s.onicestatechange=function(){o._updateIceConnectionState(),o._updateConnectionState()};var u=new e.RTCDtlsTransport(s);return u.ondtlsstatechange=function(){o._updateConnectionState()},u.onerror=function(){Object.defineProperty(u,"state",{value:"failed",writable:!0}),o._updateConnectionState()},{iceTransport:s,dtlsTransport:u}},i.prototype._disposeIceAndDtlsTransports=function(o){var s=this.transceivers[o].iceGatherer;s&&(delete s.onlocalcandidate,delete this.transceivers[o].iceGatherer);var u=this.transceivers[o].iceTransport;u&&(delete u.onicestatechange,delete this.transceivers[o].iceTransport);var f=this.transceivers[o].dtlsTransport;f&&(delete f.ondtlsstatechange,delete f.onerror,delete this.transceivers[o].dtlsTransport)},i.prototype._transceive=function(o,s,u){var f=jt(o.localCapabilities,o.remoteCapabilities);s&&o.rtpSender&&(f.encodings=o.sendEncodingParameters,f.rtcp={cname:B.localCName,compound:o.rtcpParameters.compound},o.recvEncodingParameters.length&&(f.rtcp.ssrc=o.recvEncodingParameters[0].ssrc),o.rtpSender.send(f)),u&&o.rtpReceiver&&f.codecs.length>0&&(o.kind==="video"&&o.recvEncodingParameters&&t<15019&&o.recvEncodingParameters.forEach(function(p){delete p.rtx}),o.recvEncodingParameters.length?f.encodings=o.recvEncodingParameters:f.encodings=[{}],f.rtcp={compound:o.rtcpParameters.compound},o.rtcpParameters.cname&&(f.rtcp.cname=o.rtcpParameters.cname),o.sendEncodingParameters.length&&(f.rtcp.ssrc=o.sendEncodingParameters[0].ssrc),o.rtpReceiver.receive(f))},i.prototype.setLocalDescription=function(o){var s=this;if(["offer","answer"].indexOf(o.type)===-1)return Promise.reject(Ee("TypeError",'Unsupported type "'+o.type+'"'));if(!Yn("setLocalDescription",o.type,s.signalingState)||s._isClosed)return Promise.reject(Ee("InvalidStateError","Can not set local "+o.type+" in state "+s.signalingState));var u,f;if(o.type==="offer")u=B.splitSections(o.sdp),f=u.shift(),u.forEach(function(m,h){var v=B.parseRtpParameters(m);s.transceivers[h].localCapabilities=v}),s.transceivers.forEach(function(m,h){s._gather(m.mid,h)});else if(o.type==="answer"){u=B.splitSections(s._remoteDescription.sdp),f=u.shift();var p=B.matchPrefix(f,"a=ice-lite").length>0;u.forEach(function(m,h){var v=s.transceivers[h],b=v.iceGatherer,g=v.iceTransport,y=v.dtlsTransport,T=v.localCapabilities,k=v.remoteCapabilities,S=B.isRejected(m)&&B.matchPrefix(m,"a=bundle-only").length===0;if(!S&&!v.rejected){var M=B.getIceParameters(m,f),P=B.getDtlsParameters(m,f);p&&(P.role="server"),(!s.usingBundle||h===0)&&(s._gather(v.mid,h),g.state==="new"&&g.start(b,M,p?"controlling":"controlled"),y.state==="new"&&y.start(P));var x=jt(T,k);s._transceive(v,x.codecs.length>0,!1)}})}return s._localDescription={type:o.type,sdp:o.sdp},o.type==="offer"?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),Promise.resolve()},i.prototype.setRemoteDescription=function(o){var s=this;if(["offer","answer"].indexOf(o.type)===-1)return Promise.reject(Ee("TypeError",'Unsupported type "'+o.type+'"'));if(!Yn("setRemoteDescription",o.type,s.signalingState)||s._isClosed)return Promise.reject(Ee("InvalidStateError","Can not set remote "+o.type+" in state "+s.signalingState));var u={};s.remoteStreams.forEach(function(g){u[g.id]=g});var f=[],p=B.splitSections(o.sdp),m=p.shift(),h=B.matchPrefix(m,"a=ice-lite").length>0,v=B.matchPrefix(m,"a=group:BUNDLE ").length>0;s.usingBundle=v;var b=B.matchPrefix(m,"a=ice-options:")[0];return b?s.canTrickleIceCandidates=b.substr(14).split(" ").indexOf("trickle")>=0:s.canTrickleIceCandidates=!1,p.forEach(function(g,y){var T=B.splitLines(g),k=B.getKind(g),S=B.isRejected(g)&&B.matchPrefix(g,"a=bundle-only").length===0,M=T[0].substr(2).split(" ")[2],P=B.getDirection(g,m),x=B.parseMsid(g),D=B.getMid(g)||B.generateIdentifier();if(S||k==="application"&&(M==="DTLS/SCTP"||M==="UDP/DTLS/SCTP")){s.transceivers[y]={mid:D,kind:k,protocol:M,rejected:!0};return}!S&&s.transceivers[y]&&s.transceivers[y].rejected&&(s.transceivers[y]=s._createTransceiver(k,!0));var C,R,O,E,L,F,w,K,j,q=B.parseRtpParameters(g),H,N;S||(H=B.getIceParameters(g,m),N=B.getDtlsParameters(g,m),N.role="client"),w=B.parseRtpEncodingParameters(g);var $=B.parseRtcpParameters(g),U=B.matchPrefix(g,"a=end-of-candidates",m).length>0,z=B.matchPrefix(g,"a=candidate:").map(function(re){return B.parseCandidate(re)}).filter(function(re){return re.component===1});if((o.type==="offer"||o.type==="answer")&&!S&&v&&y>0&&s.transceivers[y]&&(s._disposeIceAndDtlsTransports(y),s.transceivers[y].iceGatherer=s.transceivers[0].iceGatherer,s.transceivers[y].iceTransport=s.transceivers[0].iceTransport,s.transceivers[y].dtlsTransport=s.transceivers[0].dtlsTransport,s.transceivers[y].rtpSender&&s.transceivers[y].rtpSender.setTransport(s.transceivers[0].dtlsTransport),s.transceivers[y].rtpReceiver&&s.transceivers[y].rtpReceiver.setTransport(s.transceivers[0].dtlsTransport)),o.type==="offer"&&!S){C=s.transceivers[y]||s._createTransceiver(k),C.mid=D,C.iceGatherer||(C.iceGatherer=s._createIceGatherer(y,v)),z.length&&C.iceTransport.state==="new"&&(U&&(!v||y===0)?C.iceTransport.setRemoteCandidates(z):z.forEach(function(re){hr(C.iceTransport,re)})),K=e.RTCRtpReceiver.getCapabilities(k),t<15019&&(K.codecs=K.codecs.filter(function(re){return re.name!=="rtx"})),F=C.sendEncodingParameters||[{ssrc:(2*y+2)*1001}];var W=!1;if(P==="sendrecv"||P==="sendonly"){if(W=!C.rtpReceiver,L=C.rtpReceiver||new e.RTCRtpReceiver(C.dtlsTransport,k),W){var X;j=L.track,x&&x.stream==="-"||(x?(u[x.stream]||(u[x.stream]=new e.MediaStream,Object.defineProperty(u[x.stream],"id",{get:function(){return x.stream}})),Object.defineProperty(j,"id",{get:function(){return x.track}}),X=u[x.stream]):(u.default||(u.default=new e.MediaStream),X=u.default)),X&&(r(j,X),C.associatedRemoteMediaStreams.push(X)),f.push([j,L,X])}}else C.rtpReceiver&&C.rtpReceiver.track&&(C.associatedRemoteMediaStreams.forEach(function(re){var J=re.getTracks().find(function(ne){return ne.id===C.rtpReceiver.track.id});J&&n(J,re)}),C.associatedRemoteMediaStreams=[]);C.localCapabilities=K,C.remoteCapabilities=q,C.rtpReceiver=L,C.rtcpParameters=$,C.sendEncodingParameters=F,C.recvEncodingParameters=w,s._transceive(s.transceivers[y],!1,W)}else if(o.type==="answer"&&!S){C=s.transceivers[y],R=C.iceGatherer,O=C.iceTransport,E=C.dtlsTransport,L=C.rtpReceiver,F=C.sendEncodingParameters,K=C.localCapabilities,s.transceivers[y].recvEncodingParameters=w,s.transceivers[y].remoteCapabilities=q,s.transceivers[y].rtcpParameters=$,z.length&&O.state==="new"&&((h||U)&&(!v||y===0)?O.setRemoteCandidates(z):z.forEach(function(re){hr(C.iceTransport,re)})),(!v||y===0)&&(O.state==="new"&&O.start(R,H,"controlling"),E.state==="new"&&E.start(N));var ie=jt(C.localCapabilities,C.remoteCapabilities),Re=ie.codecs.filter(function(re){return re.name.toLowerCase()==="rtx"}).length;!Re&&C.sendEncodingParameters[0].rtx&&delete C.sendEncodingParameters[0].rtx,s._transceive(C,P==="sendrecv"||P==="recvonly",P==="sendrecv"||P==="sendonly"),L&&(P==="sendrecv"||P==="sendonly")?(j=L.track,x?(u[x.stream]||(u[x.stream]=new e.MediaStream),r(j,u[x.stream]),f.push([j,L,u[x.stream]])):(u.default||(u.default=new e.MediaStream),r(j,u.default),f.push([j,L,u.default]))):delete C.rtpReceiver}}),s._dtlsRole===void 0&&(s._dtlsRole=o.type==="offer"?"active":"passive"),s._remoteDescription={type:o.type,sdp:o.sdp},o.type==="offer"?s._updateSignalingState("have-remote-offer"):s._updateSignalingState("stable"),Object.keys(u).forEach(function(g){var y=u[g];if(y.getTracks().length){if(s.remoteStreams.indexOf(y)===-1){s.remoteStreams.push(y);var T=new Event("addstream");T.stream=y,e.setTimeout(function(){s._dispatchEvent("addstream",T)})}f.forEach(function(k){var S=k[0],M=k[1];y.id===k[2].id&&a(s,S,M,[y])})}}),f.forEach(function(g){g[2]||a(s,g[0],g[1],[])}),e.setTimeout(function(){!(s&&s.transceivers)||s.transceivers.forEach(function(g){g.iceTransport&&g.iceTransport.state==="new"&&g.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),g.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach(function(o){o.iceTransport&&o.iceTransport.stop(),o.dtlsTransport&&o.dtlsTransport.stop(),o.rtpSender&&o.rtpSender.stop(),o.rtpReceiver&&o.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(o){this.signalingState=o;var s=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",s)},i.prototype._maybeFireNegotiationNeeded=function(){var o=this;this.signalingState!=="stable"||this.needNegotiation===!0||(this.needNegotiation=!0,e.setTimeout(function(){if(o.needNegotiation){o.needNegotiation=!1;var s=new Event("negotiationneeded");o._dispatchEvent("negotiationneeded",s)}},0))},i.prototype._updateIceConnectionState=function(){var o,s={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(f){f.iceTransport&&!f.rejected&&s[f.iceTransport.state]++}),o="new",s.failed>0?o="failed":s.checking>0?o="checking":s.disconnected>0?o="disconnected":s.new>0?o="new":s.connected>0?o="connected":s.completed>0&&(o="completed"),o!==this.iceConnectionState){this.iceConnectionState=o;var u=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",u)}},i.prototype._updateConnectionState=function(){var o,s={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(f){f.iceTransport&&f.dtlsTransport&&!f.rejected&&(s[f.iceTransport.state]++,s[f.dtlsTransport.state]++)}),s.connected+=s.completed,o="new",s.failed>0?o="failed":s.connecting>0?o="connecting":s.disconnected>0?o="disconnected":s.new>0?o="new":s.connected>0&&(o="connected"),o!==this.connectionState){this.connectionState=o;var u=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",u)}},i.prototype.createOffer=function(){var o=this;if(o._isClosed)return Promise.reject(Ee("InvalidStateError","Can not call createOffer after close"));var s=o.transceivers.filter(function(h){return h.kind==="audio"}).length,u=o.transceivers.filter(function(h){return h.kind==="video"}).length,f=arguments[0];if(f){if(f.mandatory||f.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");f.offerToReceiveAudio!==void 0&&(f.offerToReceiveAudio===!0?s=1:f.offerToReceiveAudio===!1?s=0:s=f.offerToReceiveAudio),f.offerToReceiveVideo!==void 0&&(f.offerToReceiveVideo===!0?u=1:f.offerToReceiveVideo===!1?u=0:u=f.offerToReceiveVideo)}for(o.transceivers.forEach(function(h){h.kind==="audio"?(s--,s<0&&(h.wantReceive=!1)):h.kind==="video"&&(u--,u<0&&(h.wantReceive=!1))});s>0||u>0;)s>0&&(o._createTransceiver("audio"),s--),u>0&&(o._createTransceiver("video"),u--);var p=B.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++);o.transceivers.forEach(function(h,v){var b=h.track,g=h.kind,y=h.mid||B.generateIdentifier();h.mid=y,h.iceGatherer||(h.iceGatherer=o._createIceGatherer(v,o.usingBundle));var T=e.RTCRtpSender.getCapabilities(g);t<15019&&(T.codecs=T.codecs.filter(function(S){return S.name!=="rtx"})),T.codecs.forEach(function(S){S.name==="H264"&&S.parameters["level-asymmetry-allowed"]===void 0&&(S.parameters["level-asymmetry-allowed"]="1"),h.remoteCapabilities&&h.remoteCapabilities.codecs&&h.remoteCapabilities.codecs.forEach(function(M){S.name.toLowerCase()===M.name.toLowerCase()&&S.clockRate===M.clockRate&&(S.preferredPayloadType=M.payloadType)})}),T.headerExtensions.forEach(function(S){var M=h.remoteCapabilities&&h.remoteCapabilities.headerExtensions||[];M.forEach(function(P){S.uri===P.uri&&(S.id=P.id)})});var k=h.sendEncodingParameters||[{ssrc:(2*v+1)*1001}];b&&t>=15019&&g==="video"&&!k[0].rtx&&(k[0].rtx={ssrc:k[0].ssrc+1}),h.wantReceive&&(h.rtpReceiver=new e.RTCRtpReceiver(h.dtlsTransport,g)),h.localCapabilities=T,h.sendEncodingParameters=k}),o._config.bundlePolicy!=="max-compat"&&(p+="a=group:BUNDLE "+o.transceivers.map(function(h){return h.mid}).join(" ")+`\r
`),p+=`a=ice-options:trickle\r
`,o.transceivers.forEach(function(h,v){p+=Jn(h,h.localCapabilities,"offer",h.stream,o._dtlsRole),p+=`a=rtcp-rsize\r
`,h.iceGatherer&&o.iceGatheringState!=="new"&&(v===0||!o.usingBundle)&&(h.iceGatherer.getLocalCandidates().forEach(function(b){b.component=1,p+="a="+B.writeCandidate(b)+`\r
`}),h.iceGatherer.state==="completed"&&(p+=`a=end-of-candidates\r
`))});var m=new e.RTCSessionDescription({type:"offer",sdp:p});return Promise.resolve(m)},i.prototype.createAnswer=function(){var o=this;if(o._isClosed)return Promise.reject(Ee("InvalidStateError","Can not call createAnswer after close"));if(!(o.signalingState==="have-remote-offer"||o.signalingState==="have-local-pranswer"))return Promise.reject(Ee("InvalidStateError","Can not call createAnswer in signalingState "+o.signalingState));var s=B.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++);o.usingBundle&&(s+="a=group:BUNDLE "+o.transceivers.map(function(p){return p.mid}).join(" ")+`\r
`),s+=`a=ice-options:trickle\r
`;var u=B.getMediaSections(o._remoteDescription.sdp).length;o.transceivers.forEach(function(p,m){if(!(m+1>u)){if(p.rejected){p.kind==="application"?p.protocol==="DTLS/SCTP"?s+=`m=application 0 DTLS/SCTP 5000\r
`:s+="m=application 0 "+p.protocol+` webrtc-datachannel\r
`:p.kind==="audio"?s+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:p.kind==="video"&&(s+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),s+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+p.mid+`\r
`;return}if(p.stream){var h;p.kind==="audio"?h=p.stream.getAudioTracks()[0]:p.kind==="video"&&(h=p.stream.getVideoTracks()[0]),h&&t>=15019&&p.kind==="video"&&!p.sendEncodingParameters[0].rtx&&(p.sendEncodingParameters[0].rtx={ssrc:p.sendEncodingParameters[0].ssrc+1})}var v=jt(p.localCapabilities,p.remoteCapabilities),b=v.codecs.filter(function(g){return g.name.toLowerCase()==="rtx"}).length;!b&&p.sendEncodingParameters[0].rtx&&delete p.sendEncodingParameters[0].rtx,s+=Jn(p,v,"answer",p.stream,o._dtlsRole),p.rtcpParameters&&p.rtcpParameters.reducedSize&&(s+=`a=rtcp-rsize\r
`)}});var f=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(f)},i.prototype.addIceCandidate=function(o){var s=this,u;return o&&!(o.sdpMLineIndex!==void 0||o.sdpMid)?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(f,p){if(s._remoteDescription)if(!o||o.candidate==="")for(var m=0;m<s.transceivers.length&&!(!s.transceivers[m].rejected&&(s.transceivers[m].iceTransport.addRemoteCandidate({}),u=B.getMediaSections(s._remoteDescription.sdp),u[m]+=`a=end-of-candidates\r
`,s._remoteDescription.sdp=B.getDescription(s._remoteDescription.sdp)+u.join(""),s.usingBundle));m++);else{var h=o.sdpMLineIndex;if(o.sdpMid){for(var v=0;v<s.transceivers.length;v++)if(s.transceivers[v].mid===o.sdpMid){h=v;break}}var b=s.transceivers[h];if(b){if(b.rejected)return f();var g=Object.keys(o.candidate).length>0?B.parseCandidate(o.candidate):{};if(g.protocol==="tcp"&&(g.port===0||g.port===9)||g.component&&g.component!==1)return f();if((h===0||h>0&&b.iceTransport!==s.transceivers[0].iceTransport)&&!hr(b.iceTransport,g))return p(Ee("OperationError","Can not add ICE candidate"));var y=o.candidate.trim();y.indexOf("a=")===0&&(y=y.substr(2)),u=B.getMediaSections(s._remoteDescription.sdp),u[h]+="a="+(g.type?y:"end-of-candidates")+`\r
`,s._remoteDescription.sdp=B.getDescription(s._remoteDescription.sdp)+u.join("")}else return p(Ee("OperationError","Can not add ICE candidate"))}else return p(Ee("InvalidStateError","Can not add ICE candidate without a remote description"));f()})},i.prototype.getStats=function(o){if(o&&o instanceof e.MediaStreamTrack){var s=null;if(this.transceivers.forEach(function(f){f.rtpSender&&f.rtpSender.track===o?s=f.rtpSender:f.rtpReceiver&&f.rtpReceiver.track===o&&(s=f.rtpReceiver)}),!s)throw Ee("InvalidAccessError","Invalid selector.");return s.getStats()}var u=[];return this.transceivers.forEach(function(f){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(p){f[p]&&u.push(f[p].getStats())})}),Promise.all(u).then(function(f){var p=new Map;return f.forEach(function(m){m.forEach(function(h){p.set(h.id,h)})}),p})};var c=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];c.forEach(function(o){var s=e[o];if(s&&s.prototype&&s.prototype.getStats){var u=s.prototype.getStats;s.prototype.getStats=function(){return u.apply(this).then(function(f){var p=new Map;return Object.keys(f).forEach(function(m){f[m].type=_s(f[m]),p.set(m,f[m])}),p})}}});var l=["createOffer","createAnswer"];return l.forEach(function(o){var s=i.prototype[o];i.prototype[o]=function(){var u=arguments;return typeof u[0]=="function"||typeof u[1]=="function"?s.apply(this,[arguments[2]]).then(function(f){typeof u[0]=="function"&&u[0].apply(null,[f])},function(f){typeof u[1]=="function"&&u[1].apply(null,[f])}):s.apply(this,arguments)}}),l=["setLocalDescription","setRemoteDescription","addIceCandidate"],l.forEach(function(o){var s=i.prototype[o];i.prototype[o]=function(){var u=arguments;return typeof u[1]=="function"||typeof u[2]=="function"?s.apply(this,arguments).then(function(){typeof u[1]=="function"&&u[1].apply(null)},function(f){typeof u[2]=="function"&&u[2].apply(null,[f])}):s.apply(this,arguments)}}),["getStats"].forEach(function(o){var s=i.prototype[o];i.prototype[o]=function(){var u=arguments;return typeof u[1]=="function"?s.apply(this,arguments).then(function(){typeof u[1]=="function"&&u[1].apply(null)}):s.apply(this,arguments)}}),i};function Xn(e){const t=e&&e.navigator,r=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString(){return this.name}}},n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(a){return n(a).catch(i=>Promise.reject(r(i)))}}function Qn(e){"getDisplayMedia"in e.navigator&&(!e.navigator.mediaDevices||e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function mr(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(a){return a}),e.RTCSessionDescription||(e.RTCSessionDescription=function(a){return a}),t.version<15025)){const n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(a){n.set.call(this,a);const i=new Event("enabled");i.enabled=a,this.dispatchEvent(i)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new e.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const r=ks(e,t.version);e.RTCPeerConnection=function(a){return a&&a.iceServers&&(a.iceServers=Ss(a.iceServers,t.version),ur("ICE servers after filtering:",a.iceServers)),new r(a)},e.RTCPeerConnection.prototype=r.prototype}function Zn(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var ea=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",shimPeerConnection:mr,shimReplaceTrack:Zn,shimGetUserMedia:Xn,shimGetDisplayMedia:Qn});function ta(e,t){const r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(a,i,c){Mt("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(a).then(i,c)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const a=function(c,l,o){l in c&&!(o in c)&&(c[o]=c[l],delete c[l])},i=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(c){return typeof c=="object"&&typeof c.audio=="object"&&(c=JSON.parse(JSON.stringify(c)),a(c.audio,"autoGainControl","mozAutoGainControl"),a(c.audio,"noiseSuppression","mozNoiseSuppression")),i(c)},n&&n.prototype.getSettings){const c=n.prototype.getSettings;n.prototype.getSettings=function(){const l=c.apply(this,arguments);return a(l,"mozAutoGainControl","autoGainControl"),a(l,"mozNoiseSuppression","noiseSuppression"),l}}if(n&&n.prototype.applyConstraints){const c=n.prototype.applyConstraints;n.prototype.applyConstraints=function(l){return this.kind==="audio"&&typeof l=="object"&&(l=JSON.parse(JSON.stringify(l)),a(l,"autoGainControl","mozAutoGainControl"),a(l,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[l])}}}}function Es(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){const a=new DOMException("getDisplayMedia without video constraints is undefined");return a.name="NotFoundError",a.code=8,Promise.reject(a)}return n.video===!0?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function ra(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function vr(e,t){if(typeof e!="object"||!(e.RTCPeerConnection||e.mozRTCPeerConnection))return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){const i=e.RTCPeerConnection.prototype[a],c={[a](){return arguments[0]=new(a==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[a]=c[a]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[i,c,l]=arguments;return n.apply(this,[i||null]).then(o=>{if(t.version<53&&!c)try{o.forEach(s=>{s.type=r[s.type]||s.type})}catch(s){if(s.name!=="TypeError")throw s;o.forEach((u,f)=>{o.set(f,Object.assign({},u,{type:r[u.type]||u.type}))})}return o}).then(c,l)}}function na(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const a=t.apply(this,[]);return a.forEach(i=>i._pc=this),a});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const a=r.apply(this,arguments);return a._pc=this,a}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function aa(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const n=t.apply(this,[]);return n.forEach(a=>a._pc=this),n}),it(e,"track",r=>(r.receiver._pc=r.srcElement,r)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function ia(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(r){Mt("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&r.getTracks().includes(n.track)&&this.removeTrack(n)})})}function oa(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function sa(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const n=arguments[1],a=n&&"sendEncodings"in n;a&&n.sendEncodings.forEach(c=>{if("rid"in c&&!/^[a-z0-9]{0,16}$/i.test(c.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in c&&!(parseFloat(c.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in c&&!(parseFloat(c.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=t.apply(this,arguments);if(a){const{sender:c}=i,l=c.getParameters();(!("encodings"in l)||l.encodings.length===1&&Object.keys(l.encodings[0]).length===0)&&(l.encodings=n.sendEncodings,c.sendEncodings=n.sendEncodings,this.setParametersPromises.push(c.setParameters(l).then(()=>{delete c.sendEncodings}).catch(()=>{delete c.sendEncodings})))}return i})}function ca(e){if(!(typeof e=="object"&&e.RTCRtpSender))return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const n=t.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function la(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function ua(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var fa=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",shimOnTrack:ra,shimPeerConnection:vr,shimSenderGetStats:na,shimReceiverGetStats:aa,shimRemoveStream:ia,shimRTCDataChannel:oa,shimAddTransceiver:sa,shimGetParameters:ca,shimCreateOffer:la,shimCreateAnswer:ua,shimGetUserMedia:ta,shimGetDisplayMedia:Es});function da(e){if(!(typeof e!="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(a=>t.call(this,a,n)),n.getVideoTracks().forEach(a=>t.call(this,a,n))},e.RTCPeerConnection.prototype.addTrack=function(n,...a){return a&&a.forEach(i=>{this._localStreams?this._localStreams.includes(i)||this._localStreams.push(i):this._localStreams=[i]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(r){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(r);if(n===-1)return;this._localStreams.splice(n,1);const a=r.getTracks();this.getSenders().forEach(i=>{a.includes(i.track)&&this.removeTrack(i)})})}}function pa(e){if(!(typeof e!="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach(a=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(a))return;this._remoteStreams.push(a);const i=new Event("addstream");i.stream=a,this.dispatchEvent(i)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(i=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(i)>=0)return;n._remoteStreams.push(i);const c=new Event("addstream");c.stream=i,n.dispatchEvent(c)})}),t.apply(n,arguments)}}}function ha(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,a=t.setLocalDescription,i=t.setRemoteDescription,c=t.addIceCandidate;t.createOffer=function(s,u){const f=arguments.length>=2?arguments[2]:arguments[0],p=r.apply(this,[f]);return u?(p.then(s,u),Promise.resolve()):p},t.createAnswer=function(s,u){const f=arguments.length>=2?arguments[2]:arguments[0],p=n.apply(this,[f]);return u?(p.then(s,u),Promise.resolve()):p};let l=function(o,s,u){const f=a.apply(this,[o]);return u?(f.then(s,u),Promise.resolve()):f};t.setLocalDescription=l,l=function(o,s,u){const f=i.apply(this,[o]);return u?(f.then(s,u),Promise.resolve()):f},t.setRemoteDescription=l,l=function(o,s,u){const f=c.apply(this,[o]);return u?(f.then(s,u),Promise.resolve()):f},t.addIceCandidate=l}function ma(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=a=>n(va(a))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(n,a,i){t.mediaDevices.getUserMedia(n).then(a,i)}.bind(t))}function va(e){return e&&e.video!==void 0?Object.assign({},e,{video:Fn(e.video)}):e}function ga(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(n,a){if(n&&n.iceServers){const i=[];for(let c=0;c<n.iceServers.length;c++){let l=n.iceServers[c];!l.hasOwnProperty("urls")&&l.hasOwnProperty("url")?(Mt("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,i.push(l)):i.push(n.iceServers[c])}n.iceServers=i}return new t(n,a)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return t.generateCertificate}})}function ya(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ba(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio!="undefined"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const a=this.getTransceivers().find(c=>c.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):n.offerToReceiveAudio===!0&&!a&&this.addTransceiver("audio"),typeof n.offerToReceiveVideo!="undefined"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const i=this.getTransceivers().find(c=>c.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):n.offerToReceiveVideo===!0&&!i&&this.addTransceiver("video")}return t.apply(this,arguments)}}function Ca(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var xa=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",shimLocalStreamsAPI:da,shimRemoteStreamsAPI:pa,shimCallbacksAPI:ha,shimGetUserMedia:ma,shimConstraints:va,shimRTCIceServerUrls:ga,shimTrackEventTransceiver:ya,shimCreateOfferLegacy:ba,shimAudioContext:Ca});function At(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substr(2)),n.candidate&&n.candidate.length){const a=new t(n),i=Nt.parseCandidate(n.candidate),c=Object.assign(a,i);return c.toJSON=function(){return{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex,usernameFragment:c.usernameFragment}},c}return new t(n)},e.RTCIceCandidate.prototype=t.prototype,it(e,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new e.RTCIceCandidate(r.candidate),writable:"false"}),r))}function gt(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp=="undefined"?null:this._sctp}});const r=function(l){if(!l||!l.sdp)return!1;const o=Nt.splitSections(l.sdp);return o.shift(),o.some(s=>{const u=Nt.parseMLine(s);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},n=function(l){const o=l.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(o===null||o.length<2)return-1;const s=parseInt(o[1],10);return s!==s?-1:s},a=function(l){let o=65536;return t.browser==="firefox"&&(t.version<57?l===-1?o=16384:o=2147483637:t.version<60?o=t.version===57?65535:65536:o=2147483637),o},i=function(l,o){let s=65536;t.browser==="firefox"&&t.version===57&&(s=65535);const u=Nt.matchPrefix(l.sdp,"a=max-message-size:");return u.length>0?s=parseInt(u[0].substr(19),10):t.browser==="firefox"&&o!==-1&&(s=2147483637),s},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:o}=this.getConfiguration();o==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp=="undefined"?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const o=n(arguments[0]),s=a(o),u=i(arguments[0],o);let f;s===0&&u===0?f=Number.POSITIVE_INFINITY:s===0||u===0?f=Math.max(s,u):f=Math.min(s,u);const p={};Object.defineProperty(p,"maxMessageSize",{get(){return f}}),this._sctp=p}return c.apply(this,arguments)}}function yt(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(n,a){const i=n.send;n.send=function(){const l=arguments[0],o=l.length||l.size||l.byteLength;if(n.readyState==="open"&&a.sctp&&o>a.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+a.sctp.maxMessageSize+" bytes)");return i.apply(n,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const a=r.apply(this,arguments);return t(a,this),a},it(e,"datachannel",n=>(t(n.channel,n.target),n))}function gr(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const n=t[r];t[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=a=>{const i=a.target;if(i._lastConnectionState!==i.connectionState){i._lastConnectionState=i.connectionState;const c=new Event("connectionstatechange",a);i.dispatchEvent(c)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function yr(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(a){if(a&&a.sdp&&a.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const i=a.sdp.split(`
`).filter(c=>c.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&a instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:a.type,sdp:i}):a.sdp=i}return r.apply(this,arguments)}}function Ft(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const r=e.RTCPeerConnection.prototype.addIceCandidate;!r||r.length===0||(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}var Ps=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",shimRTCIceCandidate:At,shimMaxMessageSize:gt,shimSendThrowTypeError:yt,shimConnectionState:gr,removeExtmapAllowMixed:yr,shimAddIceCandidateNullOrEmpty:Ft});function Rs({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const r=ur,n=Cs(e),a={browserDetails:n,commonShim:Ps,extractVersion:vt,disableLog:ys,disableWarnings:bs};switch(n.browser){case"chrome":if(!Hn||!dr||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),a;if(n.version===null)return r("Chrome shim can not determine version, not shimming."),a;r("adapter.js shimming chrome."),a.browserShim=Hn,Ft(e,n),$n(e,n),wn(e),dr(e,n),zn(e),Kn(e,n),Gn(e),Un(e),Vn(e),qn(e,n),At(e),gr(e),gt(e,n),yt(e),yr(e,n);break;case"firefox":if(!fa||!vr||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),a;r("adapter.js shimming firefox."),a.browserShim=fa,Ft(e,n),ta(e,n),vr(e,n),ra(e),ia(e),na(e),aa(e),oa(e),sa(e),ca(e),la(e),ua(e),At(e),gr(e),gt(e,n),yt(e);break;case"edge":if(!ea||!mr||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),a;r("adapter.js shimming edge."),a.browserShim=ea,Xn(e),Qn(e),mr(e,n),Zn(e),gt(e,n),yt(e);break;case"safari":if(!xa||!t.shimSafari)return r("Safari shim is not included in this adapter release."),a;r("adapter.js shimming safari."),a.browserShim=xa,Ft(e,n),ga(e),ba(e),ha(e),da(e),pa(e),ya(e),ma(e),Ca(e),At(e),gt(e,n),yt(e),yr(e,n);break;default:r("Unsupported browser!");break}return a}const Sa=Rs({window:typeof window=="undefined"?void 0:window});function ze(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var br=Sa.default||Sa,bt=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return typeof RTCPeerConnection!="undefined"},e.prototype.isBrowserSupported=function(){var t=this.getBrowser(),r=this.getVersion(),n=this.supportedBrowsers.includes(t);return n?t==="chrome"?r>=this.minChromeVersion:t==="firefox"?r>=this.minFirefoxVersion:t==="safari"?!this.isIOS&&r>=this.minSafariVersion:!1:!1},e.prototype.getBrowser=function(){return br.browserDetails.browser},e.prototype.getVersion=function(){return br.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var t=this.getBrowser(),r=br.browserDetails.version||0;if(t==="chrome"&&r<this.minChromeVersion)return!1;if(t==="firefox"&&r>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var n,a=!1;try{n=new RTCPeerConnection,n.addTransceiver("audio"),a=!0}catch{}finally{n&&n.close()}return a},e.prototype.toString=function(){return`Supports:
    browser:`.concat(this.getBrowser(),`
    version:`).concat(this.getVersion(),`
    isIOS:`).concat(this.isIOS,`
    isWebRTCSupported:`).concat(this.isWebRTCSupported(),`
    isBrowserSupported:`).concat(this.isBrowserSupported(),`
    isUnifiedPlanSupported:`).concat(this.isUnifiedPlanSupported())},e}()),_a={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"},Os=function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=_a,this.browser=bt.getBrowser(),this.browserVersion=bt.getVersion(),this.supports=function(){var t={browser:bt.isBrowserSupported(),webRTC:bt.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;var r;try{r=new RTCPeerConnection(_a),t.audioVideo=!0;var n=void 0;try{n=r.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!bt.isIOS}catch{}}catch{}finally{n&&n.close()}}catch{}finally{r&&r.close()}return t}(),this.pack=Mn.pack,this.unpack=Mn.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(t){return!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t)},e.prototype.chunk=function(t){for(var r=[],n=t.size,a=Math.ceil(n/Z.chunkedMTU),i=0,c=0;c<n;){var l=Math.min(n,c+Z.chunkedMTU),o=t.slice(c,l),s={__peerData:this._dataCount,n:i,data:o,total:a};r.push(s),c=l,i++}return this._dataCount++,r},e.prototype.blobToArrayBuffer=function(t,r){var n=new FileReader;return n.onload=function(a){a.target&&r(a.target.result)},n.readAsArrayBuffer(t),n},e.prototype.binaryStringToArrayBuffer=function(t){for(var r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n)&255;return r.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).slice(2)},e.prototype.isSecure=function(){return location.protocol==="https:"},e}(),Z=new Os,Ta={};ze(Ta,"Peer",()=>$a,e=>$a=e);var Ct={},Ds=Object.prototype.hasOwnProperty,De="~";function xt(){}Object.create&&(xt.prototype=Object.create(null),new xt().__proto__||(De=!1));function Is(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function ka(e,t,r,n,a){if(typeof r!="function")throw new TypeError("The listener must be a function");var i=new Is(r,n||e,a),c=De?De+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],i]:e._events[c].push(i):(e._events[c]=i,e._eventsCount++),e}function Lt(e,t){--e._eventsCount==0?e._events=new xt:delete e._events[t]}function Pe(){this._events=new xt,this._eventsCount=0}Pe.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)Ds.call(r,n)&&t.push(De?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};Pe.prototype.listeners=function(t){var r=De?De+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var a=0,i=n.length,c=new Array(i);a<i;a++)c[a]=n[a].fn;return c};Pe.prototype.listenerCount=function(t){var r=De?De+t:t,n=this._events[r];return n?n.fn?1:n.length:0};Pe.prototype.emit=function(t,r,n,a,i,c){var l=De?De+t:t;if(!this._events[l])return!1;var o=this._events[l],s=arguments.length,u,f;if(o.fn){switch(o.once&&this.removeListener(t,o.fn,void 0,!0),s){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,r),!0;case 3:return o.fn.call(o.context,r,n),!0;case 4:return o.fn.call(o.context,r,n,a),!0;case 5:return o.fn.call(o.context,r,n,a,i),!0;case 6:return o.fn.call(o.context,r,n,a,i,c),!0}for(f=1,u=new Array(s-1);f<s;f++)u[f-1]=arguments[f];o.fn.apply(o.context,u)}else{var p=o.length,m;for(f=0;f<p;f++)switch(o[f].once&&this.removeListener(t,o[f].fn,void 0,!0),s){case 1:o[f].fn.call(o[f].context);break;case 2:o[f].fn.call(o[f].context,r);break;case 3:o[f].fn.call(o[f].context,r,n);break;case 4:o[f].fn.call(o[f].context,r,n,a);break;default:if(!u)for(m=1,u=new Array(s-1);m<s;m++)u[m-1]=arguments[m];o[f].fn.apply(o[f].context,u)}}return!0};Pe.prototype.on=function(t,r,n){return ka(this,t,r,n,!1)};Pe.prototype.once=function(t,r,n){return ka(this,t,r,n,!0)};Pe.prototype.removeListener=function(t,r,n,a){var i=De?De+t:t;if(!this._events[i])return this;if(!r)return Lt(this,i),this;var c=this._events[i];if(c.fn)c.fn===r&&(!a||c.once)&&(!n||c.context===n)&&Lt(this,i);else{for(var l=0,o=[],s=c.length;l<s;l++)(c[l].fn!==r||a&&!c[l].once||n&&c[l].context!==n)&&o.push(c[l]);o.length?this._events[i]=o.length===1?o[0]:o:Lt(this,i)}return this};Pe.prototype.removeAllListeners=function(t){var r;return t?(r=De?De+t:t,this._events[r]&&Lt(this,r)):(this._events=new xt,this._eventsCount=0),this};Pe.prototype.off=Pe.prototype.removeListener;Pe.prototype.addListener=Pe.prototype.on;Pe.prefixed=De;Pe.EventEmitter=Pe;Ct=Pe;var I={};ze(I,"LogLevel",()=>Ie,e=>Ie=e);ze(I,"default",()=>Ea,e=>Ea=e);var rt=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,i=[],c;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(l){c={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return i},nt=function(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},Ms="PeerJS: ",Ie;(function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"})(Ie||(Ie={}));var Ns=function(){function e(){this._logLevel=Ie.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){this._logLevel=t},enumerable:!1,configurable:!0}),e.prototype.log=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._logLevel>=Ie.All&&this._print.apply(this,nt([Ie.All],rt(t),!1))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._logLevel>=Ie.Warnings&&this._print.apply(this,nt([Ie.Warnings],rt(t),!1))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._logLevel>=Ie.Errors&&this._print.apply(this,nt([Ie.Errors],rt(t),!1))},e.prototype.setLogFunction=function(t){this._print=t},e.prototype._print=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=nt([Ms],rt(r),!1);for(var i in a)a[i]instanceof Error&&(a[i]="("+a[i].name+") "+a[i].message);t>=Ie.All?console.log.apply(console,nt([],rt(a),!1)):t>=Ie.Warnings?console.warn.apply(console,nt(["WARNING"],rt(a),!1)):t>=Ie.Errors&&console.error.apply(console,nt(["ERROR"],rt(a),!1))},e}(),Ea=new Ns,Pa={};ze(Pa,"Socket",()=>Ra,e=>Ra=e);var $e;(function(e){e.Data="data",e.Media="media"})($e||($e={}));var pe;(function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"})(pe||(pe={}));var We;(function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"})(We||(We={}));var Ke;(function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"})(Ke||(Ke={}));var xe;(function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"})(xe||(xe={}));var Cr={};Cr=JSON.parse('{"name":"peerjs","version":"1.4.6","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz St\xFCckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","So\u0308ren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"type":"module","sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.cjs","browser-unminified":"dist/peerjs.cjs","types":"dist/types.d.ts","engines":{"node":">= 10"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"includeNodeModules":true,"context":"browser","optimize":true,"engines":{"browsers":"cover 99%, not dead"},"source":"lib/global.ts"},"browser-unminified":{"includeNodeModules":true,"context":"browser","optimize":false,"engines":{"browsers":"cover 99%, not dead"},"source":"lib/global.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build && cp dist/peerjs.cjs dist/peerjs.js && cp dist/peerjs.min.cjs dist/peerjs.min.js","prepublishOnly":"npm run build","test":"mocha -r ts-node/register -r jsdom-global/register test/**/*.ts","format":"prettier --write .","semantic-release":"semantic-release"},"devDependencies":{"@parcel/config-default":"^2.5.0","@parcel/packager-ts":"^2.5.0","@parcel/transformer-typescript-tsc":"^2.5.0","@parcel/transformer-typescript-types":"^2.5.0","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@types/chai":"^4.3.0","@types/mocha":"^9.1.0","@types/node":"^17.0.18","chai":"^4.3.6","git-authors-cli":"^1.0.40","jsdom":"^19.0.0","jsdom-global":"^3.0.2","mocha":"^9.2.0","mock-socket":"8.0.5","parcel":"^2.5.0","parcel-transformer-tsc-sourcemaps":"^1.0.2","prettier":"^2.6.2","semantic-release":"^19.0.2","standard":"^16.0.4","ts-node":"^10.5.0","typescript":"^4.5.5"},"dependencies":{"@swc/helpers":"^0.3.13","eventemitter3":"^4.0.7","peerjs-js-binarypack":"1.0.1","webrtc-adapter":"^7.7.1"}}');var js=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),As=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,i=[],c;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(l){c={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return i},Fs=function(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},Ls=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ra=function(e){js(t,e);function t(r,n,a,i,c,l){l===void 0&&(l=5e3);var o=e.call(this)||this;o.pingInterval=l,o._disconnected=!0,o._messagesQueue=[];var s=r?"wss://":"ws://";return o._baseUrl=s+n+":"+a+i+"peerjs?key="+c,o}return t.prototype.start=function(r,n){var a=this;this._id=r;var i="".concat(this._baseUrl,"&id=").concat(r,"&token=").concat(n);!!this._socket||!this._disconnected||(this._socket=new WebSocket(i+"&version="+Cr.version),this._disconnected=!1,this._socket.onmessage=function(c){var l;try{l=JSON.parse(c.data),I.default.log("Server message received:",l)}catch{I.default.log("Invalid server message",c.data);return}a.emit(Ke.Message,l)},this._socket.onclose=function(c){a._disconnected||(I.default.log("Socket closed.",c),a._cleanup(),a._disconnected=!0,a.emit(Ke.Disconnected))},this._socket.onopen=function(){a._disconnected||(a._sendQueuedMessages(),I.default.log("Socket open"),a._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var r=this;this._wsPingTimer=setTimeout(function(){r._sendHeartbeat()},this.pingInterval)},t.prototype._sendHeartbeat=function(){if(!this._wsOpen()){I.default.log("Cannot send heartbeat, because socket closed");return}var r=JSON.stringify({type:xe.Heartbeat});this._socket.send(r),this._scheduleHeartbeat()},t.prototype._wsOpen=function(){return!!this._socket&&this._socket.readyState===1},t.prototype._sendQueuedMessages=function(){var r,n,a=Fs([],As(this._messagesQueue),!1);this._messagesQueue=[];try{for(var i=Ls(a),c=i.next();!c.done;c=i.next()){var l=c.value;this.send(l)}}catch(o){r={error:o}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.send=function(r){if(!this._disconnected){if(!this._id){this._messagesQueue.push(r);return}if(!r.type){this.emit(Ke.Error,"Invalid message");return}if(!!this._wsOpen()){var n=JSON.stringify(r);this._socket.send(n)}}},t.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},t.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t}(Ct.EventEmitter),xr={};ze(xr,"MediaConnection",()=>Ia,e=>Ia=e);var Sr={};ze(Sr,"Negotiator",()=>Oa,e=>Oa=e);var Bt=function(){return Bt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Bt.apply(this,arguments)},$t=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(c){c(i)})}return new(r||(r=Promise))(function(i,c){function l(u){try{s(n.next(u))}catch(f){c(f)}}function o(u){try{s(n.throw(u))}catch(f){c(f)}}function s(u){u.done?i(u.value):a(u.value).then(l,o)}s((n=n.apply(e,t||[])).next())})},wt=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,c;return c={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function l(s){return function(u){return o([s,u])}}function o(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=s[0]&2?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,a=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(u){s=[6,u],a=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Oa=function(){function e(t){this.connection=t}return e.prototype.startConnection=function(t){var r=this._startPeerConnection();if(this.connection.peerConnection=r,this.connection.type===$e.Media&&t._stream&&this._addTracksToConnection(t._stream,r),t.originator){if(this.connection.type===$e.Data){var n=this.connection,a={ordered:!!t.reliable},i=r.createDataChannel(n.label,a);n.initialize(i)}this._makeOffer()}else this.handleSDP("OFFER",t.sdp)},e.prototype._startPeerConnection=function(){I.default.log("Creating RTCPeerConnection.");var t=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(t),t},e.prototype._setupListeners=function(t){var r=this,n=this.connection.peer,a=this.connection.connectionId,i=this.connection.type,c=this.connection.provider;I.default.log("Listening for ICE candidates."),t.onicecandidate=function(l){!l.candidate||!l.candidate.candidate||(I.default.log("Received ICE candidates for ".concat(n,":"),l.candidate),c.socket.send({type:xe.Candidate,payload:{candidate:l.candidate,type:i,connectionId:a},dst:n}))},t.oniceconnectionstatechange=function(){switch(t.iceConnectionState){case"failed":I.default.log("iceConnectionState is failed, closing connections to "+n),r.connection.emit("error",new Error("Negotiation of connection to "+n+" failed.")),r.connection.close();break;case"closed":I.default.log("iceConnectionState is closed, closing connections to "+n),r.connection.emit("error",new Error("Connection to "+n+" closed.")),r.connection.close();break;case"disconnected":I.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":t.onicecandidate=Z.noop;break}r.connection.emit("iceStateChanged",t.iceConnectionState)},I.default.log("Listening for data channel"),t.ondatachannel=function(l){I.default.log("Received data channel");var o=l.channel,s=c.getConnection(n,a);s.initialize(o)},I.default.log("Listening for remote stream"),t.ontrack=function(l){I.default.log("Received remote stream");var o=l.streams[0],s=c.getConnection(n,a);if(s.type===$e.Media){var u=s;r._addStreamToMediaConnection(o,u)}}},e.prototype.cleanup=function(){I.default.log("Cleaning up PeerConnection to "+this.connection.peer);var t=this.connection.peerConnection;if(!!t){this.connection.peerConnection=null,t.onicecandidate=t.oniceconnectionstatechange=t.ondatachannel=t.ontrack=function(){};var r=t.signalingState!=="closed",n=!1;if(this.connection.type===$e.Data){var a=this.connection,i=a.dataChannel;i&&(n=!!i.readyState&&i.readyState!=="closed")}(r||n)&&t.close()}},e.prototype._makeOffer=function(){return $t(this,void 0,Promise,function(){var t,r,n,a,i,c,l;return wt(this,function(o){switch(o.label){case 0:t=this.connection.peerConnection,r=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,t.createOffer(this.connection.options.constraints)];case 2:n=o.sent(),I.default.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,t.setLocalDescription(n)];case 4:return o.sent(),I.default.log("Set localDescription:",n,"for:".concat(this.connection.peer)),a={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:Z.browser},this.connection.type===$e.Data&&(i=this.connection,a=Bt(Bt({},a),{label:i.label,reliable:i.reliable,serialization:i.serialization})),r.socket.send({type:xe.Offer,payload:a,dst:this.connection.peer}),[3,6];case 5:return c=o.sent(),c!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(r.emitError(pe.WebRTC,c),I.default.log("Failed to setLocalDescription, ",c)),[3,6];case 6:return[3,8];case 7:return l=o.sent(),r.emitError(pe.WebRTC,l),I.default.log("Failed to createOffer, ",l),[3,8];case 8:return[2]}})})},e.prototype._makeAnswer=function(){return $t(this,void 0,Promise,function(){var t,r,n,a,i;return wt(this,function(c){switch(c.label){case 0:t=this.connection.peerConnection,r=this.connection.provider,c.label=1;case 1:return c.trys.push([1,7,,8]),[4,t.createAnswer()];case 2:n=c.sent(),I.default.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),c.label=3;case 3:return c.trys.push([3,5,,6]),[4,t.setLocalDescription(n)];case 4:return c.sent(),I.default.log("Set localDescription:",n,"for:".concat(this.connection.peer)),r.socket.send({type:xe.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:Z.browser},dst:this.connection.peer}),[3,6];case 5:return a=c.sent(),r.emitError(pe.WebRTC,a),I.default.log("Failed to setLocalDescription, ",a),[3,6];case 6:return[3,8];case 7:return i=c.sent(),r.emitError(pe.WebRTC,i),I.default.log("Failed to create answer, ",i),[3,8];case 8:return[2]}})})},e.prototype.handleSDP=function(t,r){return $t(this,void 0,Promise,function(){var n,a,i,c;return wt(this,function(l){switch(l.label){case 0:r=new RTCSessionDescription(r),n=this.connection.peerConnection,a=this.connection.provider,I.default.log("Setting remote description",r),i=this,l.label=1;case 1:return l.trys.push([1,5,,6]),[4,n.setRemoteDescription(r)];case 2:return l.sent(),I.default.log("Set remoteDescription:".concat(t," for:").concat(this.connection.peer)),t!=="OFFER"?[3,4]:[4,i._makeAnswer()];case 3:l.sent(),l.label=4;case 4:return[3,6];case 5:return c=l.sent(),a.emitError(pe.WebRTC,c),I.default.log("Failed to setRemoteDescription, ",c),[3,6];case 6:return[2]}})})},e.prototype.handleCandidate=function(t){return $t(this,void 0,Promise,function(){var r,n,a,i,c,l;return wt(this,function(o){switch(o.label){case 0:I.default.log("handleCandidate:",t),r=t.candidate,n=t.sdpMLineIndex,a=t.sdpMid,i=this.connection.peerConnection,c=this.connection.provider,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.addIceCandidate(new RTCIceCandidate({sdpMid:a,sdpMLineIndex:n,candidate:r}))];case 2:return o.sent(),I.default.log("Added ICE candidate for:".concat(this.connection.peer)),[3,4];case 3:return l=o.sent(),c.emitError(pe.WebRTC,l),I.default.log("Failed to handleCandidate, ",l),[3,4];case 4:return[2]}})})},e.prototype._addTracksToConnection=function(t,r){if(I.default.log("add tracks from stream ".concat(t.id," to peer connection")),!r.addTrack)return I.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");t.getTracks().forEach(function(n){r.addTrack(n,t)})},e.prototype._addStreamToMediaConnection=function(t,r){I.default.log("add stream ".concat(t.id," to media connection ").concat(r.connectionId)),r.addStream(t)},e}(),_r={};ze(_r,"BaseConnection",()=>Da,e=>Da=e);var Bs=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Da=function(e){Bs(t,e);function t(r,n,a){var i=e.call(this)||this;return i.peer=r,i.provider=n,i.options=a,i._open=!1,i.metadata=a.metadata,i}return Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),t}(Ct.EventEmitter),$s=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),zt=function(){return zt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},zt.apply(this,arguments)},ws=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ia=function(e){$s(t,e);function t(r,n,a){var i=e.call(this,r,n,a)||this;return i._localStream=i.options._stream,i.connectionId=i.options.connectionId||t.ID_PREFIX+Z.randomToken(),i._negotiator=new Sr.Negotiator(i),i._localStream&&i._negotiator.startConnection({_stream:i._localStream,originator:!0}),i}return Object.defineProperty(t.prototype,"type",{get:function(){return $e.Media},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!1,configurable:!0}),t.prototype.addStream=function(r){I.default.log("Receiving stream",r),this._remoteStream=r,e.prototype.emit.call(this,"stream",r)},t.prototype.handleMessage=function(r){var n=r.type,a=r.payload;switch(r.type){case xe.Answer:this._negotiator.handleSDP(n,a.sdp),this._open=!0;break;case xe.Candidate:this._negotiator.handleCandidate(a.candidate);break;default:I.default.warn("Unrecognized message type:".concat(n," from peer:").concat(this.peer));break}},t.prototype.answer=function(r,n){var a,i;if(n===void 0&&(n={}),this._localStream){I.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=r,n&&n.sdpTransform&&(this.options.sdpTransform=n.sdpTransform),this._negotiator.startConnection(zt(zt({},this.options._payload),{_stream:r}));var c=this.provider._getMessages(this.connectionId);try{for(var l=ws(c),o=l.next();!o.done;o=l.next()){var s=o.value;this.handleMessage(s)}}catch(u){a={error:u}}finally{try{o&&!o.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}this._open=!0},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),!!this.open&&(this._open=!1,e.prototype.emit.call(this,"close"))},t.ID_PREFIX="mc_",t}(_r.BaseConnection),Tr={};ze(Tr,"DataConnection",()=>ja,e=>ja=e);var Ma={};ze(Ma,"EncodingQueue",()=>Na,e=>Na=e);var zs=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Na=function(e){zs(t,e);function t(){var r=e.call(this)||this;return r.fileReader=new FileReader,r._queue=[],r._processing=!1,r.fileReader.onload=function(n){r._processing=!1,n.target&&r.emit("done",n.target.result),r.doNextTask()},r.fileReader.onerror=function(n){I.default.error("EncodingQueue error:",n),r._processing=!1,r.destroy(),r.emit("error",n)},r}return Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!1,configurable:!0}),t.prototype.enque=function(r){this.queue.push(r),!this.processing&&this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){this.size!==0&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(Ct.EventEmitter),Gs=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Us=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ja=function(e){Gs(t,e);function t(r,n,a){var i=e.call(this,r,n,a)||this;return i.stringify=JSON.stringify,i.parse=JSON.parse,i._buffer=[],i._bufferSize=0,i._buffering=!1,i._chunkedData={},i._encodingQueue=new Ma.EncodingQueue,i.connectionId=i.options.connectionId||t.ID_PREFIX+Z.randomToken(),i.label=i.options.label||i.connectionId,i.serialization=i.options.serialization||We.Binary,i.reliable=!!i.options.reliable,i._encodingQueue.on("done",function(c){i._bufferedSend(c)}),i._encodingQueue.on("error",function(){I.default.error("DC#".concat(i.connectionId,": Error occured in encoding from blob to arraybuffer, close DC")),i.close()}),i._negotiator=new Sr.Negotiator(i),i._negotiator.startConnection(i.options._payload||{originator:!0}),i}return Object.defineProperty(t.prototype,"type",{get:function(){return $e.Data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!1,configurable:!0}),t.prototype.initialize=function(r){this._dc=r,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var r=this;(!Z.supports.binaryBlob||Z.supports.reliable)&&(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){I.default.log("DC#".concat(r.connectionId," dc connection success")),r._open=!0,r.emit("open")},this.dataChannel.onmessage=function(n){I.default.log("DC#".concat(r.connectionId," dc onmessage:"),n.data),r._handleDataMessage(n)},this.dataChannel.onclose=function(){I.default.log("DC#".concat(r.connectionId," dc closed for:"),r.peer),r.close()}},t.prototype._handleDataMessage=function(r){var n=this,a=r.data,i=a.constructor,c=this.serialization===We.Binary||this.serialization===We.BinaryUTF8,l=a;if(c){if(i===Blob){Z.blobToArrayBuffer(a,function(s){var u=Z.unpack(s);n.emit("data",u)});return}else if(i===ArrayBuffer)l=Z.unpack(a);else if(i===String){var o=Z.binaryStringToArrayBuffer(a);l=Z.unpack(o)}}else this.serialization===We.JSON&&(l=this.parse(a));if(l.__peerData){this._handleChunk(l);return}e.prototype.emit.call(this,"data",l)},t.prototype._handleChunk=function(r){var n=r.__peerData,a=this._chunkedData[n]||{data:[],count:0,total:r.total};if(a.data[r.n]=r.data,a.count++,this._chunkedData[n]=a,a.total===a.count){delete this._chunkedData[n];var i=new Blob(a.data);this._handleDataMessage({data:i})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),!!this.open&&(this._open=!1,e.prototype.emit.call(this,"close"))},t.prototype.send=function(r,n){if(!this.open){e.prototype.emit.call(this,"error",new Error("Connection is not open. You should listen for the `open` event before sending messages."));return}if(this.serialization===We.JSON)this._bufferedSend(this.stringify(r));else if(this.serialization===We.Binary||this.serialization===We.BinaryUTF8){var a=Z.pack(r);if(!n&&a.size>Z.chunkedMTU){this._sendChunks(a);return}Z.supports.binaryBlob?this._bufferedSend(a):this._encodingQueue.enque(a)}else this._bufferedSend(r)},t.prototype._bufferedSend=function(r){(this._buffering||!this._trySend(r))&&(this._buffer.push(r),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(r){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(function(){n._buffering=!1,n._tryBuffer()},50),!1;try{this.dataChannel.send(r)}catch(a){return I.default.error("DC#:".concat(this.connectionId," Error when sending:"),a),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){if(!!this.open&&this._buffer.length!==0){var r=this._buffer[0];this._trySend(r)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},t.prototype._sendChunks=function(r){var n,a,i=Z.chunk(r);I.default.log("DC#".concat(this.connectionId," Try to send ").concat(i.length," chunks..."));try{for(var c=Us(i),l=c.next();!l.done;l=c.next()){var o=l.value;this.send(o,!0)}}catch(s){n={error:s}}finally{try{l&&!l.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}},t.prototype.handleMessage=function(r){var n=r.payload;switch(r.type){case xe.Answer:this._negotiator.handleSDP(r.type,n.sdp);break;case xe.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:I.default.warn("Unrecognized message type:",r.type,"from peer:",this.peer);break}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(_r.BaseConnection),Aa={};ze(Aa,"API",()=>Ba,e=>Ba=e);var Fa=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(c){c(i)})}return new(r||(r=Promise))(function(i,c){function l(u){try{s(n.next(u))}catch(f){c(f)}}function o(u){try{s(n.throw(u))}catch(f){c(f)}}function s(u){u.done?i(u.value):a(u.value).then(l,o)}s((n=n.apply(e,t||[])).next())})},La=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,c;return c={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function l(s){return function(u){return o([s,u])}}function o(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=s[0]&2?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,a=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(u){s=[6,u],a=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Ba=function(){function e(t){this._options=t}return e.prototype._buildRequest=function(t){var r=this._options.secure?"https":"http",n=this._options,a=n.host,i=n.port,c=n.path,l=n.key,o=new URL("".concat(r,"://").concat(a,":").concat(i).concat(c).concat(l,"/").concat(t));return o.searchParams.set("ts","".concat(Date.now()).concat(Math.random())),o.searchParams.set("version",Cr.version),fetch(o.href,{referrerPolicy:this._options.referrerPolicy})},e.prototype.retrieveId=function(){return Fa(this,void 0,Promise,function(){var t,r,n;return La(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this._buildRequest("id")];case 1:if(t=a.sent(),t.status!==200)throw new Error("Error. Status:".concat(t.status));return[2,t.text()];case 2:throw r=a.sent(),I.default.error("Error retrieving ID",r),n="",this._options.path==="/"&&this._options.host!==Z.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n);case 3:return[2]}})})},e.prototype.listAllPeers=function(){return Fa(this,void 0,Promise,function(){var t,r,n;return La(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this._buildRequest("peers")];case 1:if(t=a.sent(),t.status!==200)throw t.status===401?(r="",this._options.host===Z.CLOUD_HOST?r="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":r="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+r)):new Error("Error. Status:".concat(t.status));return[2,t.json()];case 2:throw n=a.sent(),I.default.error("Error retrieving list peers",n),new Error("Could not get list peers from the server."+n);case 3:return[2]}})})},e}(),Vs=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),St=function(){return St=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},St.apply(this,arguments)},_t=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ws=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,i=[],c;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(l){c={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return i},$a=function(e){Vs(t,e);function t(r,n){var a=e.call(this)||this;a._id=null,a._lastServerId=null,a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map;var i;return r&&r.constructor==Object?n=r:r&&(i=r.toString()),n=St({debug:0,host:Z.CLOUD_HOST,port:Z.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:Z.randomToken(),config:Z.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin"},n),a._options=n,a._options.host==="/"&&(a._options.host=window.location.hostname),a._options.path&&(a._options.path[0]!=="/"&&(a._options.path="/"+a._options.path),a._options.path[a._options.path.length-1]!=="/"&&(a._options.path+="/")),a._options.secure===void 0&&a._options.host!==Z.CLOUD_HOST?a._options.secure=Z.isSecure():a._options.host==Z.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&I.default.setLogFunction(a._options.logFunction),I.default.logLevel=a._options.debug||0,a._api=new Aa.API(n),a._socket=a._createServerConnection(),!Z.supports.audioVideo&&!Z.supports.data?(a._delayedAbort(pe.BrowserIncompatible,"The current browser does not support WebRTC"),a):!!i&&!Z.validateId(i)?(a._delayedAbort(pe.InvalidID,'ID "'.concat(i,'" is invalid')),a):(i?a._initialize(i):a._api.retrieveId().then(function(c){return a._initialize(c)}).catch(function(c){return a._abort(pe.ServerError,c)}),a)}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var r,n,a=Object.create(null);try{for(var i=_t(this._connections),c=i.next();!c.done;c=i.next()){var l=Ws(c.value,2),o=l[0],s=l[1];a[o]=s}}catch(u){r={error:u}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!1,configurable:!0}),t.prototype._createServerConnection=function(){var r=this,n=new Pa.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return n.on(Ke.Message,function(a){r._handleMessage(a)}),n.on(Ke.Error,function(a){r._abort(pe.SocketError,a)}),n.on(Ke.Disconnected,function(){r.disconnected||(r.emitError(pe.Network,"Lost connection to server."),r.disconnect())}),n.on(Ke.Close,function(){r.disconnected||r._abort(pe.SocketClosed,"Underlying socket is already closed.")}),n},t.prototype._initialize=function(r){this._id=r,this.socket.start(r,this._options.token)},t.prototype._handleMessage=function(r){var n,a,i=r.type,c=r.payload,l=r.src;switch(i){case xe.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case xe.Error:this._abort(pe.ServerError,c.msg);break;case xe.IdTaken:this._abort(pe.UnavailableID,'ID "'.concat(this.id,'" is taken'));break;case xe.InvalidKey:this._abort(pe.InvalidKey,'API KEY "'.concat(this._options.key,'" is invalid'));break;case xe.Leave:I.default.log("Received leave message from ".concat(l)),this._cleanupPeer(l),this._connections.delete(l);break;case xe.Expire:this.emitError(pe.PeerUnavailable,"Could not connect to peer ".concat(l));break;case xe.Offer:var o=c.connectionId,s=this.getConnection(l,o);if(s&&(s.close(),I.default.warn("Offer received for existing Connection ID:".concat(o))),c.type===$e.Media){var u=new xr.MediaConnection(l,this,{connectionId:o,_payload:c,metadata:c.metadata});s=u,this._addConnection(l,s),this.emit("call",u)}else if(c.type===$e.Data){var f=new Tr.DataConnection(l,this,{connectionId:o,_payload:c,metadata:c.metadata,label:c.label,serialization:c.serialization,reliable:c.reliable});s=f,this._addConnection(l,s),this.emit("connection",f)}else{I.default.warn("Received malformed connection type:".concat(c.type));return}var p=this._getMessages(o);try{for(var m=_t(p),h=m.next();!h.done;h=m.next()){var v=h.value;s.handleMessage(v)}}catch(b){n={error:b}}finally{try{h&&!h.done&&(a=m.return)&&a.call(m)}finally{if(n)throw n.error}}break;default:if(!c){I.default.warn("You received a malformed message from ".concat(l," of type ").concat(i));return}var o=c.connectionId,s=this.getConnection(l,o);s&&s.peerConnection?s.handleMessage(r):o?this._storeMessage(o,r):I.default.warn("You received an unrecognized message:",r);break}},t.prototype._storeMessage=function(r,n){this._lostMessages.has(r)||this._lostMessages.set(r,[]),this._lostMessages.get(r).push(n)},t.prototype._getMessages=function(r){var n=this._lostMessages.get(r);return n?(this._lostMessages.delete(r),n):[]},t.prototype.connect=function(r,n){if(n===void 0&&(n={}),this.disconnected){I.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(pe.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}var a=new Tr.DataConnection(r,this,n);return this._addConnection(r,a),a},t.prototype.call=function(r,n,a){if(a===void 0&&(a={}),this.disconnected){I.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(pe.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!n){I.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}var i=new xr.MediaConnection(r,this,St(St({},a),{_stream:n}));return this._addConnection(r,i),i},t.prototype._addConnection=function(r,n){I.default.log("add connection ".concat(n.type,":").concat(n.connectionId," to peerId:").concat(r)),this._connections.has(r)||this._connections.set(r,[]),this._connections.get(r).push(n)},t.prototype._removeConnection=function(r){var n=this._connections.get(r.peer);if(n){var a=n.indexOf(r);a!==-1&&n.splice(a,1)}this._lostMessages.delete(r.connectionId)},t.prototype.getConnection=function(r,n){var a,i,c=this._connections.get(r);if(!c)return null;try{for(var l=_t(c),o=l.next();!o.done;o=l.next()){var s=o.value;if(s.connectionId===n)return s}}catch(u){a={error:u}}finally{try{o&&!o.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}return null},t.prototype._delayedAbort=function(r,n){var a=this;setTimeout(function(){a._abort(r,n)},0)},t.prototype._abort=function(r,n){I.default.error("Aborting!"),this.emitError(r,n),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(r,n){I.default.error("Error:",n);var a;typeof n=="string"?a=new Error(n):a=n,a.type=r,this.emit("error",a)},t.prototype.destroy=function(){this.destroyed||(I.default.log("Destroy peer with ID:".concat(this.id)),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))},t.prototype._cleanup=function(){var r,n;try{for(var a=_t(this._connections.keys()),i=a.next();!i.done;i=a.next()){var c=i.value;this._cleanupPeer(c),this._connections.delete(c)}}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}this.socket.removeAllListeners()},t.prototype._cleanupPeer=function(r){var n,a,i=this._connections.get(r);if(!!i)try{for(var c=_t(i),l=c.next();!l.done;l=c.next()){var o=l.value;o.close()}}catch(s){n={error:s}}finally{try{l&&!l.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}},t.prototype.disconnect=function(){if(!this.disconnected){var r=this.id;I.default.log("Disconnect peer with ID:".concat(r)),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=r,this._id=null,this.emit("disconnected",r)}},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)I.default.log("Attempting reconnection to server with ID ".concat(this._lastServerId)),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)I.default.error("In a hurry? We're still trying to make the initial connection!");else throw new Error("Peer ".concat(this.id," cannot reconnect because it is not disconnected from the server!"))}},t.prototype.listAllPeers=function(r){var n=this;r===void 0&&(r=function(a){}),this._api.listAllPeers().then(function(a){return r(a)}).catch(function(a){return n._abort(pe.ServerError,a)})},t.DEFAULT_KEY="peerjs",t}(Ct.EventEmitter),Ks=Ta.Peer,Gt,qs=new Uint8Array(16);function Hs(){if(!Gt&&(Gt=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Gt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Gt(qs)}var Js=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ys(e){return typeof e=="string"&&Js.test(e)}var Se=[];for(var kr=0;kr<256;++kr)Se.push((kr+256).toString(16).substr(1));function Xs(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(Se[e[t+0]]+Se[e[t+1]]+Se[e[t+2]]+Se[e[t+3]]+"-"+Se[e[t+4]]+Se[e[t+5]]+"-"+Se[e[t+6]]+Se[e[t+7]]+"-"+Se[e[t+8]]+Se[e[t+9]]+"-"+Se[e[t+10]]+Se[e[t+11]]+Se[e[t+12]]+Se[e[t+13]]+Se[e[t+14]]+Se[e[t+15]]).toLowerCase();if(!Ys(r))throw TypeError("Stringified UUID is invalid");return r}function Ut(e,t,r){e=e||{};var n=e.random||(e.rng||Hs)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=n[a];return t}return Xs(n)}const Qs="_chatRecortdItem_yvlnz_1",Zs="_record_yvlnz_5";var wa={chatRecortdItem:Qs,record:Zs};const ec=({type:e,data:t})=>{const r=e==="local";return Le("div",{style:{flexDirection:r?"row-reverse":"unset"},className:wa.chatRecortdItem,children:[Y("div",{style:r?{marginLeft:10}:{marginRight:10},children:Y(Bi,{size:36,children:e==="local"?"\u6211":"\u670B\u53CB"})}),Y("p",{className:wa.record,children:t})]})},tc="_root_13k5o_1",rc="_action_13k5o_4",nc="_chatVideo_13k5o_7",ac="_textarea_13k5o_10",ic="_chatRecords_13k5o_14";var ot={root:tc,action:rc,chatVideo:nc,textarea:ac,chatRecords:ic};const pc=()=>{const[e]=ir(),t=d.exports.useRef(),r=d.exports.useRef(null),n=d.exports.useRef(null),a=d.exports.useRef(),i=d.exports.useRef(),[c,l]=d.exports.useState(""),[o,s]=d.exports.useState(""),[u,f]=d.exports.useState([{id:Ut(),type:"remote",data:"hellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohello"},{id:Ut(),type:"local",data:"\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D\u4F60\u597D"}]),p=d.exports.useCallback(()=>{t.current=new Ks,t.current.on("open",b=>{l(b)}),t.current.on("connection",b=>{b.on("data",g=>{const y=[...u,{id:Ut(),type:"remote",data:g}];f(y)}),a.current=b}),t.current.on("call",async b=>{if(window.confirm(`\u662F\u5426\u63A5\u53D7 ${b.peer}?`)){if(!r.current)return;const g=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});r.current.srcObject=g,r.current.play(),b.answer(g),b.on("stream",y=>{!n.current||(n.current.srcObject=y,n.current.play())}),i.current=b}else b.close()})},[]),m=d.exports.useCallback(async()=>{if(!r.current)return;const b=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});if(r.current.srcObject=b,r.current.play(),!t.current)return;const g=t.current.connect(o);a.current=g,g.on("open",()=>{Hr.success("\u5DF2\u8FDE\u63A5")});const y=t.current.call(o,b);y.on("stream",T=>{!n.current||(n.current.srcObject=T,n.current.play())}),y.on("error",T=>{console.error(T)}),y.on("close",()=>{h()}),i.current=y},[o]),h=d.exports.useCallback(()=>{i.current&&i.current.close()},[]),v=d.exports.useCallback(b=>{if(a.current||Hr.warn("\u8FD8\u672A\u5EFA\u7ACB\u94FE\u63A5"),!a.current)return;a.current.send(b.message);const g=[...u,{id:Ut(),type:"local",data:b.message}];f(g),e.resetFields()},[]);return d.exports.useEffect(()=>(p(),()=>{h()}),[]),Le("div",{className:ot.root,children:[Le("h1",{children:["\u672C\u5730 Peer ID: ",c||"loading..."]}),Le(Xr,{size:15,className:ot.action,children:[Y(Jr,{value:o,type:"text",placeholder:"\u5BF9\u65B9 Peer ID",style:{width:300},onChange:b=>s(b.target.value)}),Y(Et,{type:"primary",onClick:m,children:"\u89C6\u9891\u901A\u8BDD"}),Y(Et,{type:"primary",danger:!0,onClick:h,children:"\u7ED3\u675F\u901A\u8BDD"})]}),Le(Dt,{gutter:24,children:[Y(tt,{span:12,children:Y(Ot,{title:"\u672C\u5730\u6444\u50CF\u5934",children:Y("video",{className:ot.chatVideo,controls:!0,autoPlay:!0,muted:!0,ref:r})})}),Y(tt,{span:12,children:Y(Ot,{title:"\u8FDC\u7A0B\u6444\u50CF\u5934",children:Y("video",{className:ot.chatVideo,controls:!0,autoPlay:!0,muted:!0,ref:n})})})]}),Le(Dt,{gutter:24,children:[Y(tt,{span:12,children:Y(Ot,{children:Y(Dn,{className:ot.chatRecords,size:"small",bordered:!0,dataSource:u,renderItem:b=>Y(ec,pt({},b))})})}),Y(tt,{span:12,children:Y(Ot,{children:Le(sr,{form:e,onFinish:v,children:[Y(sr.Item,{name:"message",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u804A\u5929\u5185\u5BB9"}],children:Y(Jr.TextArea,{className:ot.textarea,maxLength:500,showCount:!0,placeholder:"\u8BF7\u8F93\u5165\u804A\u5929\u5185\u5BB9"})}),Y(sr.Item,{children:Le(Xr,{children:[Y(Et,{onClick:()=>e.resetFields(),children:"\u6E05\u7A7A"}),Y(Et,{type:"primary",htmlType:"submit",children:"\u53D1\u9001\u6D88\u606F"})]})})]})})})]})]})};export{pc as default};
